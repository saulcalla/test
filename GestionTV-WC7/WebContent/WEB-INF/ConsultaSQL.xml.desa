<?xml version="1.0" encoding="ISO-8859-1" ?>

<!DOCTYPE ConsultaSQL SYSTEM "ConsultaSQL.dtd">

<ConsultaSQL>
  <NombreProyecto nombre="default">
	<NombreBean valor="GestionTVFunciones">
      <Instruccion01>
		SELECT	TO_CHAR(B.CPMFU_COD_FUN_K),
				B.CPMFU_NOM_FUN,
				TO_CHAR(B.CPMFU_COD_PAD_MEN),
				TO_CHAR(B.CPMFU_NRO_NIV_MEN),
				TO_CHAR(B.CPMFU_GLS_CNX_MEN)
		FROM	bocorp_mae_usr A, 
				bocorp_mae_fun B, 
				bocorp_mov_gru_fun C
		WHERE	A.CPMUR_RUN_USR_K=?
		AND     A.CPMUR_COC_PAS_USR =?
		AND		A.CPMGR_COD_GRU_K=C.CPMGR_COD_GRU_K
		AND		C.CPMFU_COD_FUN_K=B.CPMFU_COD_FUN_K		
		AND		B.CPMSI_COC_SIS_K=?
      </Instruccion01>
      <Instruccion02/>
      <Instruccion03/>
      <Instruccion04/>
    </NombreBean>
    <NombreBean valor="gestion_01">
      <Instruccion01>
			SELECT 	F.CPMFU_COD_FUN_K,CPMFU_NOM_FUN 
			FROM 	BOCORP_MOV_GRU_FUN GR,BOCORP_MAE_FUN F 
			WHERE 	GR.CPMGR_COD_GRU_K = ?
			AND 	GR.CPMFU_COD_FUN_K = F.CPMFU_COD_FUN_K 
			AND 	F.CPMFU_COD_FUN_K IN ?
      </Instruccion01>
      <Instruccion02>
			SELECT  CPMGR_COD_GRU_K 
			FROM 	BOCORP_MAE_USR   
			WHERE 	CPMUR_RUN_USR_K = ?
      </Instruccion02>
      <Instruccion03>
			SELECT 	CPWME_COC_SUC_EMP,CPWME_NOM_EMP,CPWME_NOM_APL_PAT_EMP,CPWME_NOM_APL_MAT_EMP,CPWME_RUN_EMP_K 
			FROM 	BOCORP_VIW_MAE_EMP   
			WHERE 	CPWME_RUN_EMP_K = ?
      </Instruccion03>

	  <!-- ========== Visitas =============================== -->	  
      <Instruccion04>
        SELECT 		DATE (stmp) AS fecha, COUNT (DISTINCT sessionid) visitas, COUNT (sessionid) paginas
        FROM 		usrtraffic   
        WHERE 		DATE (stmp) &#0062;&#0061; ?  
        			AND DATE (stmp) &#0060;&#0061; ?
        GROUP BY DATE (stmp)
      </Instruccion04>
    </NombreBean>
    
    <NombreBean valor="gestion_02">

	  <!-- ========== Pedidos =============================== -->	  
      <Instruccion01>
		SELECT  DATE (fecha_hora_creacion) AS fecha,
	    		COUNT (DISTINCT correlativo_venta) num_pedidos_boleta,1
	    FROM 	nota_venta
	    WHERE 	DATE (fecha_hora_creacion) &#0062;&#0061; ?
	    		AND DATE (fecha_hora_creacion) &#0060;&#0061; ?
	    GROUP 	BY DATE (fecha_hora_creacion)
	    UNION
	    	SELECT  DATE (fecha_hora_creacion) AS fecha,
	    			COUNT (DISTINCT correlativo_venta)num_pedidos_boleta,2
	    	FROM nota_venta
	    	WHERE DATE (fecha_hora_creacion) &#0062;&#0061; ?
	    	AND DATE (fecha_hora_creacion) &#0060;&#0061; ?
	    	AND ESTADO = 2
	    	GROUP BY DATE (fecha_hora_creacion)
	    	ORDER BY 1 desc
      </Instruccion01>

	  <!-- ========== Boletas =============================== -->	  
      <Instruccion02>
         SELECT 	DATE (fecha_hora_creacion) AS fecha, COUNT (DISTINCT correlativo_venta) boletas
         FROM   	nota_venta   
         WHERE  	DATE (fecha_hora_creacion) &#0062;&#0061; ? AND 
         			DATE (fecha_hora_creacion) &#0060;&#0061; ?
         GROUP BY 	DATE (fecha_hora_creacion)
      </Instruccion02>

	  <!-- ========== Tarjeta Ripley =============================== -->	  
      <Instruccion03>
		SELECT 
			nroventa,estado,sucursal,boleta,fecboleta,nc,fecnc,orden,basket,autor,cliente,rut,monto,mili 
		FROM (
	 		select	ROW_NUMBER() OVER (order by nv.fecha_hora_creacion) AS C1, 
				  nv.CORRELATIVO_VENTA AS nroventa 
				 ,nv.ESTADO AS estado 
				 ,suc.TVMAS_GLS_DES  AS sucursal
				 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				 ,nv.CORRELATIVO_VENTA AS orden 
				 ,nv.CORRELATIVO_VENTA AS basket 
				 ,t.CODIGO_AUTORIZADOR AS autor 
				 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				 ,INTEGER(nv.MONTO_VENTA) AS monto 
				 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
		 from    NOTA_VENTA nv,  DESPACHO d, TARJETA_RIPLEY t,FETVIR_MAE_SUC suc 
	 	 where   nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
		 and DATE(nv.fecha_hora_creacion)= ?
		 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
		 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
		 and nv.NUMERO_SUCURSAL = ? 
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ?
      </Instruccion03>

	  <!-- ========== Tarjeta Bancaria =============================== -->
      <Instruccion04>
		 SELECT 	nroventa,estado,sucursal,boleta,fecboleta,nc,fecnc,orden,basket,autor,cliente,rut,monto,mili 
		FROM (
			 select  ROW_NUMBER() OVER (order by nv.fecha_hora_creacion) AS C1 
				 ,nv.CORRELATIVO_VENTA AS nroventa 
				 ,nv.ESTADO AS estado 
				 ,suc.TVMAS_GLS_DES  AS sucursal
				 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				 ,nv.CORRELATIVO_VENTA AS orden 
				 ,nv.CORRELATIVO_VENTA AS basket 
				 ,t.CODIGO_AUTORIZADOR AS autor 
				 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				 ,INTEGER(nv.MONTO_VENTA) AS monto 
				 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
			 from     NOTA_VENTA nv,  DESPACHO d, TARJETA_BANCARIA  t ,FETVIR_MAE_SUC suc
			 where    nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
				and DATE(nv.fecha_hora_creacion)= ?
				and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				and nv.NUMERO_SUCURSAL = ? 
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ?
      </Instruccion04>
    </NombreBean>
    
    <NombreBean valor="gestion_03">

	  <!-- ========== Todas las ventas =============================== -->
      <Instruccion01>
			
			SELECT 
				mini,nroventa,estado,sucursal,fecha_creacion,fecha_confirma,boleta,fecboleta,nc,fecnc,orden,basket,autor,cliente,rut,DIRECCION_DESPACHO,monto,mili
			FROM 
			(
			  SELECT ROW_NUMBER() OVER (order by fecha_creacion) AS C1,mini,nroventa,estado,sucursal,fecha_creacion,fecha_confirma,boleta,fecboleta,nc,fecnc,orden,basket,autor,cliente,rut,DIRECCION_DESPACHO,monto,mili 
			   FROM (select 
				     case when value(nv.tvnve_gls_ore_exo,' ' ) = ' ' THEN value(substr(u.logonid,1,2),'RIPLEY')
                     ELSE  nv.tvnve_gls_ore_exo  
       			     END AS mini
					,nv.CORRELATIVO_VENTA AS nroventa 
					,nv.ESTADO AS estado 
					,suc.TVMAS_GLS_DES  AS sucursal
					,nv.fecha_hora_creacion AS fecha_creacion
					,nv.fecha_creacion AS fecha_confirma
					,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
					,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
					,nv.CORRELATIVO_VENTA AS orden 
					,nv.CORRELATIVO_VENTA AS basket 
					,char(t.CODIGO_AUTORIZADOR) AS autor 
					,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
					,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
					,DIRECCION_DESPACHO as DIRECCION_DESPACHO
					,INTEGER(nv.MONTO_VENTA) AS monto 
					,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili
				from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
					  left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_RIPLEY    t,FETVIR_MAE_SUC suc
				where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
					 and DATE(nv.fecha_hora_creacion)= ?
					 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA
					 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
					 and nv.NUMERO_SUCURSAL = ? 
			UNION    
				select  
				     case when value(nv.tvnve_gls_ore_exo,' ' ) = ' ' THEN value(substr(u.logonid,1,2),'RIPLEY')
                     ELSE  nv.tvnve_gls_ore_exo  
       			     END AS mini
					,nv.CORRELATIVO_VENTA AS nroventa 
					,nv.ESTADO AS estado 
					,suc.TVMAS_GLS_DES  AS sucursal
					,nv.fecha_hora_creacion AS fecha_creacion
					,nv.fecha_creacion AS fecha_confirma
					,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
					,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
					,nv.CORRELATIVO_VENTA AS orden 
					,nv.CORRELATIVO_VENTA AS basket 
					,char(t.CODIGO_AUTORIZADOR) AS autor 
					,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
					,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
					,DIRECCION_DESPACHO as DIRECCION_DESPACHO
					,INTEGER(nv.MONTO_VENTA) AS monto 
					,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
				from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
					   left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_BANCARIA  t ,FETVIR_MAE_SUC suc
				 where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
					 and DATE(nv.fecha_hora_creacion)= ?
					 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
					 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
					 and nv.NUMERO_SUCURSAL = ? 
			 ) DATOS
			)TABLA
			WHERE TABLA.C1 &#0062; ? 
			AND TABLA.C1  &#0060; ? 
			      
      	  </Instruccion01>

	  <!-- ========== Detalle de Productos =============================== -->      
      <Instruccion02>
		SELECT 
		mini,estado,sucursal,nroventa,FECHA_CREACION,FECHA_CONFIRMACION,boleta,fecboleta,nc,fecnc,FORMA_PAGO,rut,cliente,COD,PRODUCTO,PRECIO,descuento,UNIDADES,monto_orden,OPERADOR,mili 
		FROM (
			SELECT  ROW_NUMBER() OVER (order by nv.fecha_hora_creacion) AS C1, 
				value(substr(u.logonid,1,2),'RIPLEY')  AS mini , 
				 nv.estado AS estado,
				 suc.TVMAS_GLS_DES  AS sucursal,
				 nv.correlativo_venta AS nroventa,
				 nv.fecha_hora_creacion AS FECHA_CREACION,
				 nv.fecha_creacion AS FECHA_CONFIRMACION,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), ' ')) AS boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), ' ')) AS fecboleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), ' ')) AS nc,
				 RTRIM (VALUE (VARCHAR (DATE (art.fec_nota_credito)), ' ')) AS fecnc,
				 VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TBANCARIA') as FORMA_PAGO,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS cliente,
				 art.cod_articulo AS COD,
				 art.desc_ripley AS PRODUCTO,
				 art.precio AS PRECIO,
				 art.monto_descuento AS descuento,
				 art.unidades AS UNIDADES, 
				 INTEGER(nv.monto_venta) AS monto_orden, 
				 value(u.logonid,' ')  AS OPERADOR, 
				 substr(CHAR(FECHA_CREACION),21,6) AS mili 
			FROM     articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	 DATE (nv.fecha_hora_creacion) =  ?
				and nv.correlativo_venta = d.correlativo_venta 
				and nv.correlativo_venta = art.correlativo_venta 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				and nv.NUMERO_SUCURSAL = ? 
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ? 
      </Instruccion02>

	  <!-- ========== FonoCompra =============================== -->      
      <Instruccion03>
		SELECT 
		users_id,logonid,firstname,lastname,orders_id,status_orden,timeplaced,MONTO
			FROM 
			(
				SELECT  
					ROW_NUMBER() OVER (order by o.timeplaced,u.users_id) AS C1, 
					u.users_id as users_id,
					u.logonid as logonid, 
					a.firstname as firstname, 
					a.lastname as lastname, 
					o.orders_id as orders_id,
					CASE 
					       WHEN o.status='C' THEN 'Completo' 
					       WHEN o.status='H' THEN 'TimeOut' 
					       END status_orden ,
					o.timeplaced as timeplaced,
					INTEGER(o.totalproduct + o.totalshipping + o.totaltaxshipping + o.totaltax + o.totaladjustment) AS MONTO
				FROM 	  userreg u, address a, orders o, ordmeextn ox
				WHERE     o.orders_id = ox.orders_id  AND 
					  BIGINT(COALESCE(ox.field1,'0')) = u.users_id  AND 
					  u.users_id = a.member_id  AND 
					  a.nickname = u.logonid  AND 
					  a.selfaddress =1  AND 
					  a.status = 'P'  AND 
					  a.isprimary = 1  AND 
					  o.status IN ('C','H') AND 
					  date(o.timeplaced) &#0062;&#0061; ? AND 
					  date(o.timeplaced) &#0060; ?
			   order by  o.timeplaced,u.users_id
			) TABLA
			WHERE TABLA.C1 &#0062; ?
			AND TABLA.C1 &#0060; ?
      </Instruccion03>

	  <!-- ========== Productos con Stock =============================== -->      
      <Instruccion04>
		SELECT  SUBSTR (c.partnumber, 1, 15) AS partnumber , 
				INTEGER(i.quantity) AS quantity  
		FROM 	catentry c, catentdesc cd, inventory i 
		WHERE 	c.catentry_id = cd.catentry_id AND 
				c.catentry_id = i.catentry_id AND 
				c.markfordelete = 0 AND 
				c.buyable = 1 AND 
				cd.published = 1 AND 
				i.quantity &#0062; 0
      </Instruccion04>
    </NombreBean>
    
    <NombreBean valor="gestion_04">

	  <!-- ========== Consulta productos Sin Stock  =============================== -->
      <Instruccion01>
		SELECT  SUBSTR (c.partnumber, 1, 15) AS partnumber , 
		        INTEGER(i.quantity) AS quantity  
		FROM    catentry c, catentdesc cd, inventory i 
		WHERE   c.catentry_id = cd.catentry_id AND 
				c.catentry_id = i.catentry_id AND 
				c.markfordelete = 0 AND 
				c.buyable = 1 AND 
				cd.published = 1 AND 
				i.quantity = 0
      </Instruccion01>

	  <!-- ========== Consulta Todos los Productos  =============================== -->      
      <Instruccion02>
		SELECT  SUBSTR (c.partnumber, 1, 15) AS partnumber , 
				INTEGER(i.quantity) AS quantity 
		FROM    catentry c, catentdesc cd, inventory i 
		WHERE 	c.catentry_id = cd.catentry_id AND 
				c.catentry_id = i.catentry_id AND 
				c.markfordelete = 0 AND 
				c.buyable = 1 AND 
				cd.published = 1
      </Instruccion02>
      
	  <!-- ==========  (1) Consulta Productos =============================== -->      
	  <Instruccion03>
	  </Instruccion03>
      <!-- ==========  (4) Consulta CATALOGOS =============================== -->      
      <Instruccion04>
	  </Instruccion04>
    </NombreBean>
    <NombreBean valor="gestion_05">
      <!-- ========== (3) Consulta Listado Zonas De Marketing ========= -->
       <Instruccion01>
       </Instruccion01>
      <!-- ==========  (4) Consulta Promociones Globales =============================== -->      
       <Instruccion02>
	   </Instruccion02>
      <!-- ==========  (5) Consulta Asociaciones de Marketing =============================== -->      
       <Instruccion03>
	   </Instruccion03>
      <!-- ==========  (6) Consulta Bundles =============================== -->      
       <Instruccion04>
	   </Instruccion04>
     </NombreBean>
     <!-- ==========  Consultas para Popup =============================== -->      
     <NombreBean valor="gestion_06">
	    <Instruccion01>
	          select 	 COALESCE(xminitienda_id,0),
	          		 	 COALESCE(active,0),
		          		 COALESCE(name,' '),
		          		 COALESCE(field1,' ')
	          from   	 xminitienda 
	          order by xminitienda_id
	          fetch first 1 rows only
	    </Instruccion01>
	    <Instruccion02>
		      insert 	into xminitienda (xminitienda_id,active,name,field1) 
		      values 	(?,?,?,?)
	    </Instruccion02>
	    <Instruccion03>
	          update 	xminitienda 
	          set 		active=?,name=?,field1=? 
	          where		COALESCE(xminitienda_id,0)=? 
        </Instruccion03>
        <Instruccion04>
		      select 	COALESCE(xminitienda_id,0)
		      from   	xminitienda 
		      order by 	xminitienda_id
        </Instruccion04>
     </NombreBean>
     <NombreBean valor="gestion_07">
     	<!-- ==========  Contadores de Registros para Tarjeta Ripley  =============================== -->  
     	<Instruccion01>
     select count(1) from (
     	 select
			nv.CORRELATIVO_VENTA AS nroventa 
			 ,nv.ESTADO AS estado 
			 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
			 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
			 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
			 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
			 ,nv.CORRELATIVO_VENTA AS orden 
			 ,nv.CORRELATIVO_VENTA AS basket 
			 ,t.CODIGO_AUTORIZADOR AS autor 
			 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
			 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
			 ,INTEGER(nv.MONTO_VENTA) AS monto 
			 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
	 from    NOTA_VENTA nv,  DESPACHO d, TARJETA_RIPLEY t, FETVIR_MAE_SUC suc 
	 where   nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
		 and DATE(nv.fecha_hora_creacion)= ?
		 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
		 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
		 and nv.NUMERO_SUCURSAL = ? 
     	) TABLA
     	</Instruccion01>
     	<!-- ==========  Contadores de Registros para Tarjeta Bancaria  =============================== -->
     	<Instruccion02>
     	select count(1) from (
    		 select  
				 nv.CORRELATIVO_VENTA AS nroventa 
				 ,nv.ESTADO AS estado 
				 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				 ,nv.CORRELATIVO_VENTA AS orden 
				 ,nv.CORRELATIVO_VENTA AS basket 
				 ,t.CODIGO_AUTORIZADOR AS autor 
				 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				 ,INTEGER(nv.MONTO_VENTA) AS monto 
				 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
			 from     NOTA_VENTA nv,  DESPACHO d, TARJETA_BANCARIA  t ,FETVIR_MAE_SUC suc
			 where    nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
			 and DATE(nv.fecha_hora_creacion)= ?
			 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
			 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
			 and nv.NUMERO_SUCURSAL = ? 			 
		) TABLA
		
	    </Instruccion02>
	    <!-- ========== Contadores de Registros para Todas las ventas =============================== -->
	    <Instruccion03>
	    select count(1) from (
	    		select 
				value(substr(u.logonid,1,2),'RIPLEY')  AS mini
				,nv.CORRELATIVO_VENTA AS nroventa 
				,nv.ESTADO AS estado 
				,nv.fecha_hora_creacion AS fecha_creacion
				,nv.fecha_creacion AS fecha_confirma
				,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				,nv.CORRELATIVO_VENTA AS orden 
				,nv.CORRELATIVO_VENTA AS basket 
				,char(t.CODIGO_AUTORIZADOR)  AS autor 
				,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				,DIRECCION_DESPACHO as DIRECCION_DESPACHO
				,INTEGER(nv.MONTO_VENTA) AS monto 
				,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili
			from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
				  left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_RIPLEY    t,FETVIR_MAE_SUC suc
			where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
				 and DATE(nv.fecha_hora_creacion)= ?
				 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA
				 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				 and nv.NUMERO_SUCURSAL = ? 
		UNION    
			select  
				value(substr(u.logonid,1,2),'RIPLEY')  AS mini
				,nv.CORRELATIVO_VENTA AS nroventa 
				,nv.ESTADO AS estado 
				,nv.fecha_hora_creacion AS fecha_creacion
				,nv.fecha_creacion AS fecha_confirma
				,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				,nv.CORRELATIVO_VENTA AS orden 
				,nv.CORRELATIVO_VENTA AS basket 
				,char(t.CODIGO_AUTORIZADOR)  AS autor 
				,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				,DIRECCION_DESPACHO as DIRECCION_DESPACHO
				,INTEGER(nv.MONTO_VENTA) AS monto 
				,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
			from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
				   left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_BANCARIA  t ,FETVIR_MAE_SUC suc
			 where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
				and DATE(nv.fecha_hora_creacion)= ?
				and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				and nv.NUMERO_SUCURSAL = ? 
		)TABLA
		   
	   
	    </Instruccion03>
	    <!-- ========== Contadores de Registros Detalle Productos =============================== -->
        <Instruccion04>
         select count(1) from (
	    		SELECT  
				value(substr(u.logonid,1,2),'RIPLEY')  AS mini , 
				 nv.estado AS estado,
				 nv.correlativo_venta AS nroventa,
				 nv.fecha_hora_creacion AS FECHA_CREACION,
				 nv.fecha_creacion AS FECHA_CONFIRMACION,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), ' ')) AS boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), ' ')) AS fecboleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), ' ')) AS nc,
				 RTRIM (VALUE (VARCHAR (DATE (art.fec_nota_credito)), ' ')) AS fecnc,
				 VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TBANCARIA') as FORMA_PAGO,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS cliente,
				 art.cod_articulo AS COD,
				 art.desc_ripley AS PRODUCTO,
				 art.precio AS PRECIO,
				 art.monto_descuento AS descuento,
				 art.unidades AS UNIDADES, 
				 INTEGER(nv.monto_venta) AS monto_orden, 
				 value(u.logonid,' ')  AS OPERADOR, 
				 substr(CHAR(FECHA_CREACION),21,6) AS mili 
			FROM     articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	 DATE (nv.fecha_hora_creacion) =  ?
				AND nv.correlativo_venta = d.correlativo_venta 
				AND nv.correlativo_venta = art.correlativo_venta 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				and nv.NUMERO_SUCURSAL = ? 
		) TABLA
	    
        </Instruccion04>
     </NombreBean>
     <NombreBean valor="gestion_08">
       <!-- ========== Contadores de Registros Fono Compras =============================== -->
       <Instruccion01>
        select count(1) from (
	    		SELECT  
				    u.users_id as users_id,
					u.logonid as logonid, 
					a.firstname as firstname, 
					a.lastname as lastname, 
					o.orders_id as orders_id,
					CASE 
					       WHEN o.status='C' THEN 'Completo' 
					       WHEN o.status='H' THEN 'TimeOut' 
					       END status_orden ,
					o.timeplaced as timeplaced,
					INTEGER(o.totalproduct + o.totalshipping + o.totaltaxshipping + o.totaltax + o.totaladjustment) AS MONTO
				FROM 	  userreg u, address a, orders o, ordmeextn ox
				WHERE     o.orders_id = ox.orders_id  AND 
					  BIGINT(COALESCE(ox.field1,'0')) = u.users_id  AND 
					  u.users_id = a.member_id  AND 
					  a.nickname = u.logonid  AND 
					  a.selfaddress =1  AND 
					  a.status = 'P'  AND 
					  a.isprimary = 1  AND 
					  o.status IN ('C','H') AND 
					  date(o.timeplaced) &#0062;&#0061; ? AND 
					  date(o.timeplaced) &#0060; ?
			) TABLA

       </Instruccion01>
       
       <Instruccion02>
       </Instruccion02>
       
       <Instruccion03>
       </Instruccion03>
       
       <Instruccion04>
       </Instruccion04>
     </NombreBean>
     <NombreBean valor="gestion_09">
			<!-- ========== Tarjeta Ripley (Exportar Archivo)=============================== -->	  
      <Instruccion01>
 		select	
				  nv.CORRELATIVO_VENTA AS nroventa 
				 ,nv.ESTADO AS estado 
				 ,suc.TVMAS_GLS_DES  AS SUCURSAL
				 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				 ,nv.CORRELATIVO_VENTA AS orden 
				 ,nv.CORRELATIVO_VENTA AS basket 
				 ,t.CODIGO_AUTORIZADOR AS autor 
				 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				 ,INTEGER(nv.MONTO_VENTA) AS monto 
				 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
		 from    NOTA_VENTA nv,  DESPACHO d, TARJETA_RIPLEY t,FETVIR_MAE_SUC suc
	 	 where   nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
		 and DATE(nv.fecha_hora_creacion)= ?
		 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
		 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
		 and nv.NUMERO_SUCURSAL = ? 
      </Instruccion01>
			<!-- ========== Tarjeta Bancaria (Exportar Archivo)=============================== -->	  
      <Instruccion02>
			 select  
				 nv.CORRELATIVO_VENTA AS nroventa 
				 ,nv.ESTADO AS estado 
				 ,suc.TVMAS_GLS_DES  AS sucursal
				 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				 ,nv.CORRELATIVO_VENTA AS orden 
				 ,nv.CORRELATIVO_VENTA AS basket 
				 ,t.CODIGO_AUTORIZADOR AS autor 
				 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				 ,INTEGER(nv.MONTO_VENTA) AS monto 
				 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
			 from     NOTA_VENTA nv,  DESPACHO d, TARJETA_BANCARIA  t ,FETVIR_MAE_SUC suc
			 where    nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
				 and DATE(nv.fecha_hora_creacion)= ?
				 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
				 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				 and nv.NUMERO_SUCURSAL = ? 
       </Instruccion02>
	  <!-- ========== Todas las ventas (Exportar Archivo)=============================== -->       
       <Instruccion03>
			  SELECT mini,nroventa,estado,sucursal,fecha_creacion,fecha_confirma,boleta,fecboleta,nc,fecnc,orden,basket,autor,cliente,rut,DIRECCION_DESPACHO,monto,mili 
			   FROM (select 
				     case when value(nv.tvnve_gls_ore_exo,' ' ) = ' ' THEN value(substr(u.logonid,1,2),'RIPLEY')
                     ELSE  nv.tvnve_gls_ore_exo  
       			     END AS mini
					,nv.CORRELATIVO_VENTA AS nroventa 
					,nv.ESTADO AS estado 
					,suc.TVMAS_GLS_DES  AS sucursal
					,nv.fecha_hora_creacion AS fecha_creacion
					,nv.fecha_creacion AS fecha_confirma
					,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
					,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
					,nv.CORRELATIVO_VENTA AS orden 
					,nv.CORRELATIVO_VENTA AS basket 
					,char(t.CODIGO_AUTORIZADOR) AS autor 
					,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
					,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
					,DIRECCION_DESPACHO as DIRECCION_DESPACHO
					,INTEGER(nv.MONTO_VENTA) AS monto 
					,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili
				from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
					  left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_RIPLEY    t,FETVIR_MAE_SUC suc
				where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
					 and DATE(nv.fecha_hora_creacion)= ?
					 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA
					 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
					 and nv.NUMERO_SUCURSAL = ? 
			UNION    
				select  
				     case when value(nv.tvnve_gls_ore_exo,' ' ) = ' ' THEN value(substr(u.logonid,1,2),'RIPLEY')
                     ELSE  nv.tvnve_gls_ore_exo  
       			     END AS mini
					,nv.CORRELATIVO_VENTA AS nroventa 
					,nv.ESTADO AS estado 
					,suc.TVMAS_GLS_DES  AS sucursal
					,nv.fecha_hora_creacion AS fecha_creacion
					,nv.fecha_creacion AS fecha_confirma
					,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
					,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
					,nv.CORRELATIVO_VENTA AS orden 
					,nv.CORRELATIVO_VENTA AS basket 
					,char(t.CODIGO_AUTORIZADOR) AS autor 
					,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
					,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
					,DIRECCION_DESPACHO as DIRECCION_DESPACHO
					,INTEGER(nv.MONTO_VENTA) AS monto 
					,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
				from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
					   left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_BANCARIA  t ,FETVIR_MAE_SUC suc
				 where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
					 and DATE(nv.fecha_hora_creacion)= ?
					 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
					 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
					 and nv.NUMERO_SUCURSAL = ? 
			 ) TABLA
       
       </Instruccion03>
	  <!-- ========== Detalle de Productos (Exportar Archivo)=============================== -->              
       <Instruccion04>
			SELECT  
				value(substr(u.logonid,1,2),'RIPLEY')  AS mini , 
				 nv.estado AS estado,
				 suc.TVMAS_GLS_DES  AS sucursal,
				 nv.correlativo_venta AS nroventa,
				 nv.fecha_hora_creacion AS FECHA_CREACION,
				 nv.fecha_creacion AS FECHA_CONFIRMACION,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), ' ')) AS boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), ' ')) AS fecboleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), ' ')) AS nc,
				 RTRIM (VALUE (VARCHAR (DATE (art.fec_nota_credito)), ' ')) AS fecnc,
				 VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TBANCARIA') as FORMA_PAGO,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS cliente,
				 art.cod_articulo AS COD,
				 art.desc_ripley AS PRODUCTO,
				 art.precio AS PRECIO,
				 art.monto_descuento AS descuento,
				 art.unidades AS UNIDADES, 
				 INTEGER(nv.monto_venta) AS monto_orden, 
				 value(u.logonid,' ')  AS OPERADOR, 
				 substr(CHAR(FECHA_CREACION),21,6) AS mili 
			FROM     articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	 DATE (nv.fecha_hora_creacion) =  ?
				 AND nv.correlativo_venta = d.correlativo_venta 
				 AND nv.correlativo_venta = art.correlativo_venta 
				 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				 and nv.NUMERO_SUCURSAL = ? 
       </Instruccion04>
     </NombreBean>
     <NombreBean valor="gestion_10">
       <!-- ========== FonoCompra (Exportar Archivo)=============================== -->
       <Instruccion01>
		SELECT 
		users_id,logonid,firstname,lastname,orders_id,status_orden,timeplaced,MONTO
			FROM 
			(
				SELECT  
					u.users_id as users_id,
					u.logonid as logonid, 
					a.firstname as firstname, 
					a.lastname as lastname, 
					o.orders_id as orders_id,
					CASE 
					       WHEN o.status='C' THEN 'Completo' 
					       WHEN o.status='H' THEN 'TimeOut' 
					       END status_orden ,
					o.timeplaced as timeplaced,
					INTEGER(o.totalproduct + o.totalshipping + o.totaltaxshipping + o.totaltax + o.totaladjustment) AS MONTO
				FROM 	  userreg u, address a, orders o, ordmeextn ox
				WHERE     o.orders_id = ox.orders_id  AND 
					  BIGINT(ox.field1) = u.users_id  AND 
					  u.users_id = a.member_id  AND 
					  a.nickname = u.logonid  AND 
					  a.selfaddress =1  AND 
					  a.status = 'P'  AND 
					  a.isprimary = 1  AND 
					  o.status IN ('C','H') AND 
					  date(o.timeplaced) &#0062;&#0061; ? AND 
					  date(o.timeplaced) &#0060; ?
			   order by  o.timeplaced,u.users_id
			) TABLA
	   </Instruccion01>
        <!-- =================== Ventas  otros Origenes  ================================================= -->
        
        
       <Instruccion02>
			SELECT 
					CASE  
						WHEN value(nv.TVNVE_GLS_ORE_EXO,' ' ) = ' ' THEN value(substr(u.logonid,1,2),'RIPLEY') 
					ELSE nv.TVNVE_GLS_ORE_EXO 
					END
					AS mini, 
					nv.estado AS estado,
					nv.correlativo_venta AS nroventa,
					nv.fecha_hora_creacion AS FECHA_CREACION,
					nv.fecha_creacion AS FECHA_CONFIRMACION,
					RTRIM (VALUE (CHAR (nv.numero_boleta), ' ')) AS boleta,
					RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), ' ')) AS fecboleta,
					RTRIM (VALUE (CHAR (art.num_nota_credito), ' ')) AS nc,
					RTRIM (VALUE (VARCHAR (DATE (art.fec_nota_credito)), ' ')) AS fecnc,
					VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TBANCARIA') as FORMA_PAGO,
					RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut,
					RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS cliente,
					art.cod_articulo AS COD,
					art.desc_ripley AS PRODUCTO,
					art.precio AS PRECIO,
					art.monto_descuento AS descuento,
					art.unidades AS UNIDADES, 
					INTEGER(nv.monto_venta) AS monto_orden, 
					value(u.logonid,' ')  AS OPERADOR, 
					substr(CHAR(FECHA_CREACION),21,6) AS mili, 
					d.DIRECCION_DESPACHO AS DIRECCION_DESPACHO, 
					d.TELEFONO_DESPACHO AS TELEFONO_DESPACHO 
			FROM 	articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id 
			WHERE 	DATE (nv.fecha_hora_creacion) &#0062;&#0061; ? 
			AND 	DATE (nv.fecha_hora_creacion) &#0060; ?
			AND 	nv.correlativo_venta = d.correlativo_venta 
	    AND 	nv.correlativo_venta = art.correlativo_venta 	
	    AND 	value(nv.TVNVE_GLS_ORE_EXO,' ' )  &#0060;&#0062;  ' '
		 ORDER BY 	nv.fecha_hora_creacion asc
   
	
       	
       </Instruccion02>
       
       <Instruccion03>
       </Instruccion03>
       
       <Instruccion04>
       </Instruccion04>
     </NombreBean>

       <!-- ========== Mantenedores credito (ejecutivo-fonoCompra) =============================== -->
     <NombreBean valor="gestion_11">
       <Instruccion01>
			SELECT TVMAE_COD_EST, TVMAE_GLS_DES FROM fetvir_mae_est_bco_rip ORDER BY TVMAE_COD_EST
	   </Instruccion01>
       
       <Instruccion02>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_RUN_CLI AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_COD_EST = ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?
				    
       </Instruccion02>
       
       <Instruccion03>
			SELECT count(1)
			FROM (
				SELECT
			      1 AS C1,
			      TVMAV_NRO_CRD AS C2,
			      TVMAV_RUN_CLI AS C3,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C4,
			      TVMAV_COC_PRD AS C5,
				  TVMAV_NOM_PRD AS C6,
				  TVMAV_MNT_VTA AS C7
				FROM
				    FETVIR_MAE_VTA_BCO_RIP
				WHERE
				    TVMAV_COD_EST = ?
			) TABLA
       </Instruccion03>
       
       <Instruccion04>
				SELECT
			      TVMAV_NOM_CLI,
			      TVMAV_GLS_APL_MAT,
			      TVMAV_NRO_DML,
			      TVMAV_GLS_CON,
			      TVMAV_GLS_CIU,
			      TVMAV_GLS_FON_UNO,
			      TVMAV_COC_PRD,
			      TVMAV_GLS_OBS,
			      TVMAV_GLS_APL_PAT,
			      TVMAV_GLS_CAL,
			      TVMAV_GLS_DPT,
			      TVMAV_GLS_VLA,
			      TVMAV_GLS_REF,
    			  TVMAV_GLS_FON_DOS,
				  TVMAV_NOM_PRD,		      
				  TVMAV_RUN_CLI,
				  TVMAV_NOM_EJC,
				  TVMAV_MNT_VTA,
				  TVMAV_COD_EST
				FROM
				    FETVIR_MAE_VTA_BCO_RIP
				WHERE
				    TVMAV_NRO_CRD = ? AND
				    TVMAV_RUN_CLI = ?
       </Instruccion04>
     </NombreBean>

     <NombreBean valor="gestion_12">
       <Instruccion01>
			UPDATE FETVIR_MAE_VTA_BCO_RIP
			SET
			TVMAV_NOM_CLI = ?,
			TVMAV_GLS_APL_PAT = ?,
			TVMAV_GLS_APL_MAT = ?, 
			TVMAV_GLS_CAL = ?,
			TVMAV_NRO_DML = ?,
			TVMAV_GLS_DPT = ?,
			TVMAV_GLS_CON = ?,
			TVMAV_GLS_VLA = ?,
			TVMAV_GLS_CIU = ?,
			TVMAV_GLS_REF = ?,
			TVMAV_GLS_FON_UNO = ?,
			TVMAV_GLS_FON_DOS = ?,
			TVMAV_COC_PRD = ?,
			TVMAV_NOM_PRD = ?,
			TVMAV_MNT_VTA  = ?,
			TVMAV_GLS_OBS = ?,
			TVMAV_RUN_ID_EJC = ?			
			WHERE
		    TVMAV_NRO_CRD = ? AND
		    TVMAV_RUN_CLI = ?
			
	   </Instruccion01>
       
       <Instruccion02>
       <!-- AGA 20070803-->
		INSERT INTO FETVIR_MAE_VTA_BCO_RIP 
		    (TVMAV_NOM_EJC,
		    TVMAV_RUN_CLI,
		    TVMAV_NRO_CRD,
		    TVMAV_FCH_CRD,
		    TVMAV_NOM_CLI,
		    TVMAV_GLS_APL_PAT,
		    TVMAV_GLS_APL_MAT,
		    TVMAV_GLS_CAL,
		    TVMAV_NRO_DML,
		    TVMAV_GLS_DPT,
		    TVMAV_GLS_CON,
		    TVMAV_GLS_VLA,
		    TVMAV_GLS_CIU,
		    TVMAV_GLS_REF,
		    TVMAV_GLS_FON_UNO,
		    TVMAV_GLS_FON_DOS,
		    TVMAV_COC_PRD,
		    TVMAV_NOM_PRD,
		    TVMAV_MNT_VTA ,
		    TVMAV_COC_PRD_CAM,
		    TVMAV_NOM_PRD_CAM,
		    TVMAV_COD_EST,
		    TVMAV_NRO_OCO,
		    TVMAV_GLS_OBS,
		    TVMAV_COC_TSK,
		    TVMAV_RUN_ID_EJC)
		VALUES
		   (
		    ?,
		    ?,
		    ?,
		   CURRENT DATE,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?
		   )
	     <!-- 
	     	INSERT INTO FETVIR_MAE_VTA_BCO_RIP 
	     	(TVMAV_NOM_EJC,
		    TVMAV_RUN_CLI,
		    TVMAV_NRO_CRD,
		    TVMAV_FCH_CRD,
		    TVMAV_NOM_CLI,
		    TVMAV_GLS_APL_PAT,
		    TVMAV_GLS_APL_MAT,
		    TVMAV_GLS_CAL,
		    TVMAV_NRO_DML,
		    TVMAV_GLS_DPT,
		    TVMAV_GLS_CON,
		    TVMAV_GLS_VLA,
		    TVMAV_GLS_CIU,
		    TVMAV_GLS_REF,
		    TVMAV_GLS_FON_UNO,
		    TVMAV_GLS_FON_DOS,
		    TVMAV_COC_PRD,
		    TVMAV_NOM_PRD,
		    TVMAV_MNT_VTA ,
		    TVMAV_COC_PRD_CAM,
		    TVMAV_NOM_PRD_CAM,
		    TVMAV_COD_EST,
		    TVMAV_NRO_OCO,
		    TVMAV_GLS_OBS,
		    TVMAV_COC_TSK,
		    TVMAV_RUN_ID_EJC)
		VALUES
		   (
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?,
		    ?
		   )
		   -->
       </Instruccion02>
       
       <Instruccion03>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND
				    TVMAV_COD_EST = ? AND
				    TVMAV_RUN_ID_EJC = ?
				    AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

       </Instruccion03>
       
       <Instruccion04>
			SELECT count(1)
			FROM (
				SELECT
			      1 AS C1,
			      TVMAV_NRO_CRD AS C2,
			      TVMAV_RUN_CLI AS C3,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C4,
			      TVMAV_COC_PRD AS C5,
				  TVMAV_NOM_PRD AS C6,
				  TVMAV_MNT_VTA AS C7
				FROM
				    FETVIR_MAE_VTA_BCO_RIP
				WHERE
				    TVMAV_COD_EST = ?
				    AND TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
			) TABLA

       </Instruccion04>
     </NombreBean>

     <NombreBean valor="gestion_13">
       <Instruccion01>
			SELECT
		      TVMAV_NOM_CLI,
		      TVMAV_GLS_APL_MAT,
		      TVMAV_NRO_DML,
		      TVMAV_GLS_CON,
		      TVMAV_GLS_CIU,
		      TVMAV_GLS_FON_UNO,
		      TVMAV_COC_PRD,
		      TVMAV_GLS_OBS,
		      TVMAV_GLS_APL_PAT,
		      TVMAV_GLS_CAL,
		      TVMAV_GLS_DPT,
		      TVMAV_GLS_VLA,
		      TVMAV_GLS_REF,
   			  TVMAV_GLS_FON_DOS,
			  TVMAV_NOM_PRD,		      
			  TVMAV_RUN_CLI,
			  TVMAV_NOM_EJC,
			  TVMAV_MNT_VTA,
			  TVMAV_COC_PRD_CAM,
			  TVMAV_NOM_PRD_CAM,
			  TVMAV_COD_EST,
			  TVMAV_NRO_OCO
			FROM
			    FETVIR_MAE_VTA_BCO_RIP
			WHERE
			    TVMAV_NRO_CRD = ? AND
			    TVMAV_RUN_CLI = ?
		
	   </Instruccion01>

       <!-- ========== Modificar credito FonoCompra =============================== -->
       <Instruccion02>
			UPDATE FETVIR_MAE_VTA_BCO_RIP
			SET
			TVMAV_COC_PRD_CAM = ?,
			TVMAV_NOM_PRD_CAM = ?, 
			TVMAV_NRO_OCO = ?, 
			TVMAV_GLS_OBS = ?,
			TVMAV_COD_EST = ?,
			TVMAV_RUN_ID_FNC = ?
			WHERE
		    TVMAV_NRO_CRD = ? AND
		    TVMAV_RUN_CLI = ?
	    
       </Instruccion02>
       
       <!-- ========== Buscar credito Adm =============================== -->       
       <Instruccion03>
				SELECT
			      TVMAV_NOM_CLI,
			      TVMAV_GLS_APL_MAT,
			      TVMAV_NRO_DML,
			      TVMAV_GLS_CON,
			      TVMAV_GLS_CIU,
			      TVMAV_GLS_FON_UNO,
			      TVMAV_COC_PRD,
			      TVMAV_GLS_OBS,
			      TVMAV_GLS_APL_PAT,
			      TVMAV_GLS_CAL,
			      TVMAV_GLS_DPT,
			      TVMAV_GLS_VLA,
			      TVMAV_GLS_REF,
    			  TVMAV_GLS_FON_DOS,
				  TVMAV_NOM_PRD,		      
				  TVMAV_RUN_CLI,
				  TVMAV_RUN_ID_EJC,
				  TVMAV_MNT_VTA,
				  TVMAV_COC_PRD_CAM,
				  TVMAV_NOM_PRD_CAM,
				  TVMAV_COD_EST,
  				  TVMAV_NRO_OCO,
  				  TVMAV_NOM_EJC
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
   				    TVMAE_COD_EST = TVMAV_COD_EST AND
				    TVMAV_NRO_CRD = ? AND
				    TVMAV_RUN_CLI = ?

       </Instruccion03>

       <!-- ========== Paginacion Adm =============================== -->              
       <Instruccion04>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST 
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

       </Instruccion04>
     </NombreBean>

     <NombreBean valor="gestion_14">
       <!-- ========== Total registros Adm =============================== -->
       <Instruccion01>
			SELECT count(1)
			FROM (
				SELECT
			      1 AS C1,
			      TVMAV_NRO_CRD AS C2,
			      TVMAV_RUN_CLI AS C3,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C4,
			      TVMAV_COC_PRD AS C5,
				  TVMAV_NOM_PRD AS C6,
				  TVMAV_MNT_VTA AS C7
				FROM
				    FETVIR_MAE_VTA_BCO_RIP
			) TABLA

	   </Instruccion01>

       <!-- ========== modificar (Administrador)=============================== -->
       <Instruccion02>
			UPDATE FETVIR_MAE_VTA_BCO_RIP
			SET
			TVMAV_NOM_CLI = ?,
			TVMAV_GLS_APL_PAT = ?,
			TVMAV_GLS_APL_MAT = ?, 
			TVMAV_GLS_CAL = ?,
			TVMAV_NRO_DML = ?,
			TVMAV_GLS_DPT = ?,
			TVMAV_GLS_CON = ?,
			TVMAV_GLS_VLA = ?,
			TVMAV_GLS_CIU = ?,
			TVMAV_GLS_REF = ?,
			TVMAV_GLS_FON_UNO = ?,
			TVMAV_GLS_FON_DOS = ?,
			TVMAV_COC_PRD = ?,
			TVMAV_NOM_PRD = ?,
			TVMAV_MNT_VTA  = ?,
			TVMAV_GLS_OBS = ?,
			TVMAV_COC_PRD_CAM = ?,
			TVMAV_NOM_PRD_CAM = ?,
			TVMAV_NRO_OCO = ?,
			TVMAV_COD_EST = ?,
			TVMAV_RUN_ID_ADM = ? 
			WHERE
		    TVMAV_NRO_CRD = ? AND
		    TVMAV_RUN_CLI = ?
	    
       </Instruccion02>
       
       <!-- ========== Carga los ejecutivos =============================== -->       
       <Instruccion03>
			SELECT distinct(tvmav_run_id_ejc),tvmav_nom_ejc FROM fetvir_mae_vta_bco_rip
       </Instruccion03>

       <!-- ========== paginacion filtro1 =============================== -->              
       <Instruccion04>

			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_COD_EST = ?
				    AND TVMAV_RUN_CLI = ?
				    AND TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

       </Instruccion04>
     </NombreBean>

     <NombreBean valor="gestion_15">
       <!-- ========== paginacion filtro2 =============================== -->
       <Instruccion01>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_COD_EST = ?
				    AND TVMAV_NOM_CLI LIKE ?
				    AND TVMAV_GLS_APL_PAT LIKE ?				    
				    AND TVMAV_GLS_APL_MAT LIKE ?				    				    
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

	   </Instruccion01>

       <!-- ========== paginacion filtro3 =============================== -->
       <Instruccion02>

			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_COD_EST = ?
				    AND TVMAV_NRO_CRD = ?
				    AND TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?
	    
       </Instruccion02>
       
       <!-- ========== bco pag fecha estado   =============================== -->       
       <Instruccion03>

			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_COD_EST = ?
				    AND DATE(TVMAV_FCH_CRD) = ?
				    AND TVMAV_RUN_ID_EJC = ?
				    AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

       </Instruccion03>

       <!-- ========== paginacion filtro1 =============================== -->              
       <Instruccion04>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_RUN_CLI AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_COD_EST = ?
				    AND TVMAV_RUN_CLI = ?
				    AND TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA

       </Instruccion04>
     </NombreBean>

     <NombreBean valor="gestion_16">
       <!-- ==========  =============================== -->
       <Instruccion01>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_RUN_CLI AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_COD_EST = ?
				    AND TVMAV_NOM_CLI LIKE ?
				    AND TVMAV_GLS_APL_PAT LIKE ?				    
				    AND TVMAV_GLS_APL_MAT LIKE ?				    				    
				) TABLA

	   </Instruccion01>

       <!-- ========== =============================== -->
       <Instruccion02>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_RUN_CLI AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_COD_EST = ?
				    AND TVMAV_NRO_CRD = ?
				    AND TVMAV_RUN_ID_EJC = ?
				    AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA

       </Instruccion02>
       
       <!-- ==========  count fechaEstado ============================== -->       
       <Instruccion03>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_RUN_CLI AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_COD_EST = ?
				    AND TVMAV_FCH_CRD LIKE ?
				) TABLA

       </Instruccion03>

       <!-- ==========  estados validos =============================== -->              
       <Instruccion04>
			SELECT TVMAE_COD_EST, TVMAE_GLS_DES FROM fetvir_mae_est_bco_rip WHERE TVMAE_COD_EST &#0060;&#0062; 0 ORDER BY TVMAE_COD_EST
       </Instruccion04>
     </NombreBean>
     <NombreBean valor="gestion_17">
       <!-- ==========  buscar todos los estados =============================== -->
       <Instruccion01>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
					AND TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?										
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

	   </Instruccion01>

       <!-- ========== contador todos los estados =============================== -->
       <Instruccion02>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST 
					AND TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?										
				) TABLA

       </Instruccion02>
       
       <!-- ========== adm busca todos los estados ============================== -->       
       <Instruccion03>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST 
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

       </Instruccion03>

       <!-- ==========  adm contador todos los estados =============================== -->              
       <Instruccion04>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST 
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
       </Instruccion04>
     </NombreBean>
     <NombreBean valor="gestion_18">
       <!-- ==========  adm buscar con un estado =============================== -->
       <Instruccion01>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI)))AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST 
					AND TVMAE_COD_EST = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

	   </Instruccion01>

       <!-- ========== adm contador con un estado =============================== -->
       <Instruccion02>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI)))AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST 
					AND TVMAE_COD_EST = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA

       </Instruccion02>
       
       <!-- ==========  banco todos estado y rut ============================== -->       
       <Instruccion03>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_RUN_CLI = ? AND 
				    TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

       </Instruccion03>

       <!-- ========== contador banco todos estado y rut=============================== -->
       <Instruccion04>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_RUN_CLI = ? AND
				    TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA

       </Instruccion04>
     </NombreBean>

     <NombreBean valor="gestion_19">
       <!-- ==========  adm buscar con estado_todos y rut =============================== -->
       <Instruccion01>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
				    AND TVMAV_RUN_CLI = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?

				) TABLA

	   </Instruccion01>

       <!-- ========== adm contador con un estado =============================== -->
       <Instruccion02>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_RUN_CLI AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_COD_EST = ?
				    AND TVMAV_RUN_CLI = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA

       </Instruccion02>
       
       <!-- ==========  adm estado y rut ============================== -->       
       <Instruccion03>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
				    AND TVMAV_RUN_CLI = ? 
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

       </Instruccion03>

       <!-- ========== adm paginacion estado y rut=============================== -->
       <Instruccion04>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
				    AND TVMAV_COD_EST = ?
				    AND TVMAV_RUN_CLI = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?
       </Instruccion04>
     </NombreBean>

     <NombreBean valor="gestion_20">
       <!-- ==========  fc paginacion =============================== -->
       <Instruccion01>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND
				    TVMAV_COD_EST = ? 
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

	   </Instruccion01>

       <!-- ========== adm contador con un estado =============================== -->
       <Instruccion02>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND
				    TVMAV_COD_EST = ? 
				) TABLA

       </Instruccion02>
       
       <!-- ==========  banco todos credito ============================== -->       
       <Instruccion03>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_RUN_CLI AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    AND TVMAV_NRO_CRD = ?
				    AND TVMAV_RUN_ID_EJC = ?
				    AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
       </Instruccion03>

       <!-- ========== banco todos credito =============================== -->
       <Instruccion04>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    AND TVMAV_NRO_CRD = ?
				    AND TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?
       </Instruccion04>
     </NombreBean>
     <NombreBean valor="gestion_21">
       <!-- ==========   bco todos fecha pagina =============================== -->
       <Instruccion01>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST 
				    AND DATE(TVMAV_FCH_CRD) = ?
				    AND TVMAV_RUN_ID_EJC = ?
				    AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

	   </Instruccion01>

       <!-- ==========  bco estado fecha =============================== -->
       <Instruccion02>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST AND				
				    TVMAV_COD_EST = ?
				    AND DATE(TVMAV_FCH_CRD) = ?
				    AND TVMAV_RUN_ID_EJC = ?
				    AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
       </Instruccion02>
       
       <!-- ==========   banco total todos fecha  ============================== -->       
       <Instruccion03>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST 
				    AND DATE(TVMAV_FCH_CRD) = ?
				    AND TVMAV_RUN_ID_EJC = ?
				    AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA

       </Instruccion03>

       <!-- ========== adm todos credito =============================== -->
       <Instruccion04>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
				    AND TVMAV_NRO_CRD = ? 
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?
       </Instruccion04>
     </NombreBean>
     <NombreBean valor="gestion_22">
       <!-- ==========   adm estado credito =============================== -->
       <Instruccion01>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
				    AND TVMAV_COD_EST = ?
				    AND TVMAV_NRO_CRD = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

	   </Instruccion01>

       <!-- ==========  adm todos fecha =============================== -->
       <Instruccion02>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
					AND DATE(TVMAV_FCH_CRD) = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?
       </Instruccion02>
       
       <!-- ========== adm estado fecha  ============================== -->       
       <Instruccion03>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
					AND TVMAE_COD_EST = ?
					AND DATE(TVMAV_FCH_CRD) = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?

       </Instruccion03>

       <!-- ========== adm todos credito=============================== -->
       <Instruccion04>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
					AND TVMAV_NRO_CRD = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
       </Instruccion04>
     </NombreBean>

     <NombreBean valor="gestion_23">
       <!-- ========== adm estado credito  =============================== -->
       <Instruccion01>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
					AND TVMAE_COD_EST = ?
					AND TVMAV_NRO_CRD = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
	   </Instruccion01>

       <!-- ========== adm todos fecha =============================== -->
       <Instruccion02>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
					AND DATE(TVMAV_FCH_CRD) = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
       </Instruccion02>
       
       <!-- ========== adm estado fecha============================== -->       
       <Instruccion03>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
					AND TVMAE_COD_EST = ?
					AND DATE(TVMAV_FCH_CRD) = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
       </Instruccion03>

       <!-- ========== adm todos ejecutivo =============================== -->
       <Instruccion04>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
					AND TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA

       </Instruccion04>
     </NombreBean>
	 <NombreBean valor="gestion_24">
       <!-- ==========  adm estado ejecutivo =============================== -->
       <Instruccion01>
			SELECT count(1)
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
					AND TVMAE_COD_EST = ?
					AND TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA

       </Instruccion01>
       <!-- ==========  adm todos ejecutivo =============================== -->
	   <Instruccion02>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
					AND TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?
	   
       </Instruccion02>
       <!-- ==========  adm estadi y ejecutivo =============================== -->
       <Instruccion03>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8,C9,C10
			FROM (
				SELECT
			      ROW_NUMBER() OVER (order by TVMAV_NRO_CRD) AS C1,
			      ltrim(rtrim(char(TVMAV_NRO_CRD))||'#'||char(INTEGER(TVMAV_RUN_CLI))) AS C2,
			      TVMAV_NRO_CRD AS C3,
			      TVMAV_RUN_CLI AS C4,
				  RTRIM(substr(TVMAV_NOM_CLI || ' ' || TVMAV_GLS_APL_PAT || ' ' || TVMAV_GLS_APL_MAT,1,50)) AS C5,
				  TVMAV_COC_PRD AS C6,
				  TVMAV_NOM_PRD AS C7,
				  TVMAE_GLS_DES AS C8,				  
				  TVMAV_MNT_VTA AS C9,
				  TVMAV_NOM_EJC AS C10				  
				FROM
				    fetvir_mae_vta_bco_rip,
				    fetvir_mae_est_bco_rip
				WHERE
					TVMAE_COD_EST = TVMAV_COD_EST
					AND TVMAE_COD_EST = ?
					AND TVMAV_RUN_ID_EJC = ?
					AND TVMAV_NOM_CLI LIKE ?
					AND TVMAV_GLS_APL_PAT LIKE ?
					AND TVMAV_GLS_APL_MAT LIKE ?
				) TABLA
				WHERE TABLA.C1 &#0062; ?
				AND TABLA.C1 &#0060; ?
       
       </Instruccion03>
       
       <!-- ==========  pag tarjeta ripley datos =============================== -->
       <Instruccion04>
			SELECT C1,C2,C3,C4,C5,C6,C7,C8
			FROM (
				SELECT
					ROW_NUMBER() OVER (order by FCH_REG ASC) AS C1,
					RUT AS C2,  
					NOMBRE AS C3,
					TLF_CASA AS C4,
					TLF_TRABAJO AS C5,
					TLF_MOVIL AS C6,
					EMAIL AS C7,
					MENSAJE AS C8
					FROM XFILE 
					WHERE DATE(FCH_REG)  &#0061; ?
				) TABLA
			WHERE TABLA.C1 &#0062; ?
			AND TABLA.C1 &#0060; ?
   
       </Instruccion04>
     </NombreBean>

	 <NombreBean valor="gestion_25">
       <!-- ==========  tot tarjeta ripley datos =============================== -->
       <Instruccion01>
			SELECT count(1)
			FROM (
				SELECT
					RUT AS C2,  
					NOMBRE AS C3,
					TLF_CASA AS C4,
					TLF_TRABAJO AS C5,
					TLF_MOVIL AS C6,
					EMAIL AS C7,
					MENSAJE AS C8
					FROM XFILE 
					WHERE DATE(FCH_REG)  &#0061; ?
				) TABLA

       </Instruccion01>
       <!-- ==========  exportar tarjeta ripley datos =============================== -->
	   <Instruccion02>
			SELECT
				RUT,  
				NOMBRE,
				TLF_CASA,
				TLF_TRABAJO,
				TLF_MOVIL,
				EMAIL,
				MENSAJE
			FROM XFILE 
			WHERE DATE(FCH_REG) &#0061; ?

       </Instruccion02>
       <!-- ========== pag ripley channel =============================== -->
       <Instruccion03>
		SELECT C2,C3,C4,C5,C6
			FROM (
			SELECT
			ROW_NUMBER() OVER (order by COD_ARTICULO) AS C1,COD_ARTICULO AS C2 ,DESCRIPCION AS C3,STOCK AS C4,EN_APROBACION AS C5,VTAS_RCHANNEL AS C6
		FROM(
		SELECT COD_ARTICULO,CD.SHORTDESCRIPTION as DESCRIPCION, sum(STOCK)as STOCK,
		sum(EN_APROBACION)as EN_APROBACION,sum(VTAS_RCHANNEL)as VTAS_RCHANNEL  from
		( SELECT  B.COD_ARTICULO AS COD_ARTICULO,
          0 AS STOCK,
          SUM(B.UNIDADES) AS VTAS_RCHANNEL,
          0 AS EN_APROBACION
	    FROM NOTA_VENTA A,
         ARTICULO_VENTA B
	   WHERE A.NUMERO_SUCURSAL = 75
	     AND DATE(A.FECHA_HORA_CREACION) = ?
	     AND A.ESTADO in (1,2)
	     AND A.NUM_NOTA_CREDITO IS NULL
	     AND A.CORRELATIVO_VENTA = B.CORRELATIVO_VENTA
	   GROUP BY B.COD_ARTICULO
		UNION
		SELECT    B.COD_ARTICULO AS COD_ARTICULO,
		          0 AS STOCK,
		          0 AS VTAS_RCHANNEL,
		          SUM(B.UNIDADES) AS EN_APROBACION
		    FROM NOTA_VENTA A,
		         ARTICULO_VENTA B
		   WHERE A.NUMERO_SUCURSAL = 75
		     AND DATE(A.FECHA_HORA_CREACION) = ?
		     AND A.ESTADO in (8)
		     AND A.NUM_NOTA_CREDITO IS NULL
		     AND A.CORRELATIVO_VENTA = B.CORRELATIVO_VENTA
		   GROUP BY B.COD_ARTICULO
		UNION
		SELECT SUBSTR(A.PARTNUMBER, 1, 15) AS COD_ARTICULO,
		       INTEGER(I.QUANTITY) AS STOCK,
		       0 AS VTAS_RCHANNEL,
		       0 AS EN_APROBACION
		FROM CATENTRY A,
		     CATGPENREL B,
		     FETVIR_MAE_SUC C,
		     INVENTORY I,
		     CATENTDESC CD
		WHERE A.CATENTRY_ID = B.CATENTRY_ID
		AND A.CATENTRY_ID = I.CATENTRY_ID
		AND A.CATENTRY_ID = CD.CATENTRY_ID
		AND B.CATALOG_ID = C.TVMAS_COD_CAG_IDE
		AND A.MARKFORDELETE = 0
		AND A.BUYABLE = 1
		AND C.TVMAS_COD_SUC = 75
		) as TODO ,CATENTRY C, CATENTDESC CD
		WHERE SUBSTR(C.PARTNUMBER, 1, 15) = TODO.COD_ARTICULO
		AND C.CATENTRY_ID = CD.CATENTRY_ID
		GROUP BY CD.SHORTDESCRIPTION,COD_ARTICULO
			 ) DATOS
		)TABLA
		WHERE TABLA.C1 &#0062; ? 
		AND TABLA.C1  &#0060; ? 
      
       </Instruccion03>
       <!-- ==========  tot ripley channel  =============================== -->
       <Instruccion04>
		SELECT
			count(1)
		FROM(
		SELECT COD_ARTICULO,CD.SHORTDESCRIPTION as DESCRIPCION, sum(STOCK)as STOCK,
		sum(EN_APROBACION)as EN_APROBACION,sum(VTAS_RCHANNEL)as VTAS_RCHANNEL  from
		( SELECT  B.COD_ARTICULO AS COD_ARTICULO,
		          0 AS STOCK,
		          SUM(B.UNIDADES) AS VTAS_RCHANNEL,
		          0 AS EN_APROBACION
		    FROM NOTA_VENTA A,
		         ARTICULO_VENTA B
		   WHERE A.NUMERO_SUCURSAL = 75
		     AND DATE(A.FECHA_HORA_CREACION) = ?
		     AND A.ESTADO in (1,2)
		     AND A.NUM_NOTA_CREDITO IS NULL
		     AND A.CORRELATIVO_VENTA = B.CORRELATIVO_VENTA
		   GROUP BY B.COD_ARTICULO
		UNION
		SELECT    B.COD_ARTICULO AS COD_ARTICULO,
		          0 AS STOCK,
		          0 AS VTAS_RCHANNEL,
		          SUM(B.UNIDADES) AS EN_APROBACION
		    FROM NOTA_VENTA A,
		         ARTICULO_VENTA B
		   WHERE A.NUMERO_SUCURSAL = 75
		     AND DATE(A.FECHA_HORA_CREACION) = ?
		     AND A.ESTADO in (8)
		     AND A.NUM_NOTA_CREDITO IS NULL
		     AND A.CORRELATIVO_VENTA = B.CORRELATIVO_VENTA
		   GROUP BY B.COD_ARTICULO
		UNION
		SELECT SUBSTR(A.PARTNUMBER, 1, 15) AS COD_ARTICULO,
		       INTEGER(I.QUANTITY) AS STOCK,
		       0 AS VTAS_RCHANNEL,
		       0 AS EN_APROBACION
		FROM CATENTRY A,
		     CATGPENREL B,
		     FETVIR_MAE_SUC C,
		     INVENTORY I,
		     CATENTDESC CD
		WHERE A.CATENTRY_ID = B.CATENTRY_ID
		AND A.CATENTRY_ID = I.CATENTRY_ID
		AND A.CATENTRY_ID = CD.CATENTRY_ID
		AND B.CATALOG_ID = C.TVMAS_COD_CAG_IDE
		AND A.MARKFORDELETE = 0
		AND A.BUYABLE = 1
		AND C.TVMAS_COD_SUC = 75
		) as TODO ,CATENTRY C, CATENTDESC CD
		WHERE SUBSTR(C.PARTNUMBER, 1, 15) = TODO.COD_ARTICULO
		AND C.CATENTRY_ID = CD.CATENTRY_ID
		GROUP BY CD.SHORTDESCRIPTION,COD_ARTICULO
       	 ) DATOS
       </Instruccion04>
     </NombreBean>

	 <NombreBean valor="gestion_26">
       <!-- ========== exportar RipleyChannel =============================== -->
       <Instruccion01>

		SELECT COD_ARTICULO,CD.SHORTDESCRIPTION as DESCRIPCION, sum(STOCK)as STOCK,
		sum(EN_APROBACION)as EN_APROBACION,sum(VTAS_RCHANNEL)as VTAS_RCHANNEL  from
		( SELECT  B.COD_ARTICULO AS COD_ARTICULO,
		          0 AS STOCK,
		          SUM(B.UNIDADES) AS VTAS_RCHANNEL,
		          0 AS EN_APROBACION
		    FROM NOTA_VENTA A,
		         ARTICULO_VENTA B
		   WHERE A.NUMERO_SUCURSAL = 75
		     AND DATE(A.FECHA_HORA_CREACION) = ?
		     AND A.ESTADO in (1,2)
		     AND A.NUM_NOTA_CREDITO IS NULL
		     AND A.CORRELATIVO_VENTA = B.CORRELATIVO_VENTA
		   GROUP BY B.COD_ARTICULO
		UNION
		SELECT    B.COD_ARTICULO AS COD_ARTICULO,
	          0 AS STOCK,
	          0 AS VTAS_RCHANNEL,
	          SUM(B.UNIDADES) AS EN_APROBACION
	    FROM NOTA_VENTA A,
	         ARTICULO_VENTA B
	   WHERE A.NUMERO_SUCURSAL = 75
		     AND DATE(A.FECHA_HORA_CREACION) = ?
		     AND A.ESTADO in (8)
		     AND A.NUM_NOTA_CREDITO IS NULL
		     AND A.CORRELATIVO_VENTA = B.CORRELATIVO_VENTA
		   GROUP BY B.COD_ARTICULO
		UNION
		SELECT SUBSTR(A.PARTNUMBER, 1, 15) AS COD_ARTICULO,
		       INTEGER(I.QUANTITY) AS STOCK,
		       0 AS VTAS_RCHANNEL,
		       0 AS EN_APROBACION
		FROM CATENTRY A,
		     CATGPENREL B,
		     FETVIR_MAE_SUC C,
		     INVENTORY I,
		     CATENTDESC CD
		WHERE A.CATENTRY_ID = B.CATENTRY_ID
		AND A.CATENTRY_ID = I.CATENTRY_ID
		AND A.CATENTRY_ID = CD.CATENTRY_ID
		AND B.CATALOG_ID = C.TVMAS_COD_CAG_IDE
		AND A.MARKFORDELETE = 0
		AND A.BUYABLE = 1
		AND C.TVMAS_COD_SUC = 75
		) as TODO ,CATENTRY C, CATENTDESC CD
		WHERE SUBSTR(C.PARTNUMBER, 1, 15) = TODO.COD_ARTICULO
		AND C.CATENTRY_ID = CD.CATENTRY_ID
		GROUP BY CD.SHORTDESCRIPTION,COD_ARTICULO
       	 
       </Instruccion01>
       <!-- ========== carga sucursal =============================== -->
	   <Instruccion02>
			select TVMAS_COD_SUC, TVMAS_GLS_DES from FETVIR_MAE_SUC order by TVMAS_COD_SUC
       </Instruccion02>
       <!-- ========== contador TODAS VENTAS opcion TODAS SUCRSALES =============================== -->
       <Instruccion03>
	    select count(1) from (
	    		select 
				value(substr(u.logonid,1,2),'RIPLEY')  AS mini
				,nv.CORRELATIVO_VENTA AS nroventa 
				,nv.ESTADO AS estado 
				,nv.fecha_hora_creacion AS fecha_creacion
				,nv.fecha_creacion AS fecha_confirma
				,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				,nv.CORRELATIVO_VENTA AS orden 
				,nv.CORRELATIVO_VENTA AS basket 
				,char(t.CODIGO_AUTORIZADOR)  AS autor 
				,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				,DIRECCION_DESPACHO as DIRECCION_DESPACHO
				,INTEGER(nv.MONTO_VENTA) AS monto 
				,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili
			from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
				  left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_RIPLEY    t
			where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
				 and DATE(nv.fecha_hora_creacion)= ?
				 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA
		UNION    
			select  
				value(substr(u.logonid,1,2),'RIPLEY')  AS mini
				,nv.CORRELATIVO_VENTA AS nroventa 
				,nv.ESTADO AS estado 
				,nv.fecha_hora_creacion AS fecha_creacion
				,nv.fecha_creacion AS fecha_confirma
				,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				,nv.CORRELATIVO_VENTA AS orden 
				,nv.CORRELATIVO_VENTA AS basket 
				,char(t.CODIGO_AUTORIZADOR)  AS autor 
				,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				,DIRECCION_DESPACHO as DIRECCION_DESPACHO
				,INTEGER(nv.MONTO_VENTA) AS monto 
				,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
			from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
				   left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_BANCARIA  t
			 where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
				and DATE(nv.fecha_hora_creacion)= ?
				and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
		)TABLA
       </Instruccion03>
       <!-- ==========  paginac TODAS VENTAS opcion TODAS SUCURSALES=============================== -->
       <Instruccion04>
			SELECT 
				mini,nroventa,estado,sucursal,fecha_creacion,fecha_confirma,boleta,fecboleta,nc,fecnc,orden,basket,autor,cliente,rut,DIRECCION_DESPACHO,monto,mili
			FROM 
			(
			  SELECT ROW_NUMBER() OVER (order by fecha_creacion) AS C1,mini,nroventa,estado,sucursal,fecha_creacion,fecha_confirma,boleta,fecboleta,nc,fecnc,orden,basket,autor,cliente,rut,DIRECCION_DESPACHO,monto,mili 
			   FROM (select 
				     case when value(nv.tvnve_gls_ore_exo,' ' ) = ' ' THEN value(substr(u.logonid,1,2),'RIPLEY')
                     ELSE  nv.tvnve_gls_ore_exo  
       			     END AS mini
					,nv.CORRELATIVO_VENTA AS nroventa 
					,nv.ESTADO AS estado 
					,suc.TVMAS_GLS_DES  AS sucursal
					,nv.fecha_hora_creacion AS fecha_creacion
					,nv.fecha_creacion AS fecha_confirma
					,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
					,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
					,nv.CORRELATIVO_VENTA AS orden 
					,nv.CORRELATIVO_VENTA AS basket 
					,char(t.CODIGO_AUTORIZADOR) AS autor 
					,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
					,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
					,DIRECCION_DESPACHO as DIRECCION_DESPACHO
					,INTEGER(nv.MONTO_VENTA) AS monto 
					,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili
				from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
					  left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_RIPLEY    t,FETVIR_MAE_SUC suc
				where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
					 and DATE(nv.fecha_hora_creacion)= ?
					 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA
					 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
			UNION    
				select  
				     case when value(nv.tvnve_gls_ore_exo,' ' ) = ' ' THEN value(substr(u.logonid,1,2),'RIPLEY')
                     ELSE  nv.tvnve_gls_ore_exo  
       			     END AS mini
					,nv.CORRELATIVO_VENTA AS nroventa 
					,nv.ESTADO AS estado 
					,suc.TVMAS_GLS_DES  AS sucursal
					,nv.fecha_hora_creacion AS fecha_creacion
					,nv.fecha_creacion AS fecha_confirma
					,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
					,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
					,nv.CORRELATIVO_VENTA AS orden 
					,nv.CORRELATIVO_VENTA AS basket 
					,char(t.CODIGO_AUTORIZADOR) AS autor 
					,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
					,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
					,DIRECCION_DESPACHO as DIRECCION_DESPACHO
					,INTEGER(nv.MONTO_VENTA) AS monto 
					,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
				from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
					   left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_BANCARIA  t ,FETVIR_MAE_SUC suc
				 where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
					 and DATE(nv.fecha_hora_creacion)= ?
					 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
					 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
			 ) DATOS
			)TABLA
			WHERE TABLA.C1 &#0062; ? 
			AND TABLA.C1  &#0060; ? 
      
       </Instruccion04>
     </NombreBean>
     <NombreBean valor="gestion_27">
       <!-- ========== Detalle Producto opcion TODAS SUCURSALES =============================== -->
       <Instruccion01>
		SELECT 
		mini,estado,sucursal,nroventa,FECHA_CREACION,FECHA_CONFIRMACION,boleta,fecboleta,nc,fecnc,FORMA_PAGO,rut,cliente,COD,PRODUCTO,PRECIO,descuento,UNIDADES,monto_orden,OPERADOR,mili 
		FROM (
			SELECT  ROW_NUMBER() OVER (order by nv.fecha_hora_creacion) AS C1, 
				value(substr(u.logonid,1,2),'RIPLEY')  AS mini , 
				 nv.estado AS estado,
				 suc.TVMAS_GLS_DES  AS sucursal,
				 nv.correlativo_venta AS nroventa,
				 nv.fecha_hora_creacion AS FECHA_CREACION,
				 nv.fecha_creacion AS FECHA_CONFIRMACION,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), ' ')) AS boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), ' ')) AS fecboleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), ' ')) AS nc,
				 RTRIM (VALUE (VARCHAR (DATE (art.fec_nota_credito)), ' ')) AS fecnc,
				 VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TBANCARIA') as FORMA_PAGO,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS cliente,
				 art.cod_articulo AS COD,
				 art.desc_ripley AS PRODUCTO,
				 art.precio AS PRECIO,
				 art.monto_descuento AS descuento,
				 art.unidades AS UNIDADES, 
				 INTEGER(nv.monto_venta) AS monto_orden, 
				 value(u.logonid,' ')  AS OPERADOR, 
				 substr(CHAR(FECHA_CREACION),21,6) AS mili 
			FROM     articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	 DATE (nv.fecha_hora_creacion) =  ?
				and nv.correlativo_venta = d.correlativo_venta 
				and nv.correlativo_venta = art.correlativo_venta 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ? 

       </Instruccion01>
       <!-- ========== exportar TODAS VENTAS opcion TODAS SUCURSALES=============================== -->
	   <Instruccion02>
			  SELECT mini,nroventa,estado,sucursal,fecha_creacion,fecha_confirma,boleta,fecboleta,nc,fecnc,orden,basket,autor,cliente,rut,DIRECCION_DESPACHO,monto,mili 
			   FROM (select 
				     case when value(nv.tvnve_gls_ore_exo,' ' ) = ' ' THEN value(substr(u.logonid,1,2),'RIPLEY')
                     ELSE  nv.tvnve_gls_ore_exo  
       			     END AS mini
					,nv.CORRELATIVO_VENTA AS nroventa 
					,nv.ESTADO AS estado 
					,suc.TVMAS_GLS_DES  AS sucursal
					,nv.fecha_hora_creacion AS fecha_creacion
					,nv.fecha_creacion AS fecha_confirma
					,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
					,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
					,nv.CORRELATIVO_VENTA AS orden 
					,nv.CORRELATIVO_VENTA AS basket 
					,char(t.CODIGO_AUTORIZADOR) AS autor 
					,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
					,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
					,DIRECCION_DESPACHO as DIRECCION_DESPACHO
					,INTEGER(nv.MONTO_VENTA) AS monto 
					,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili
				from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
					  left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_RIPLEY    t,FETVIR_MAE_SUC suc
				where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
					 and DATE(nv.fecha_hora_creacion)= ?
					 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA
					 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
			UNION    
				select  
				     case when value(nv.tvnve_gls_ore_exo,' ' ) = ' ' THEN value(substr(u.logonid,1,2),'RIPLEY')
                     ELSE  nv.tvnve_gls_ore_exo  
       			     END AS mini
					,nv.CORRELATIVO_VENTA AS nroventa 
					,nv.ESTADO AS estado 
					,suc.TVMAS_GLS_DES  AS sucursal
					,nv.fecha_hora_creacion AS fecha_creacion
					,nv.fecha_creacion AS fecha_confirma
					,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
					,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
					,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
					,nv.CORRELATIVO_VENTA AS orden 
					,nv.CORRELATIVO_VENTA AS basket 
					,char(t.CODIGO_AUTORIZADOR) AS autor 
					,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
					,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
					,DIRECCION_DESPACHO as DIRECCION_DESPACHO
					,INTEGER(nv.MONTO_VENTA) AS monto 
					,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
				from  (NOTA_VENTA nv left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  
					   left join userreg u on BIGINT(ox.field1) = u.users_id ,  DESPACHO d, TARJETA_BANCARIA  t ,FETVIR_MAE_SUC suc
				 where nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
					 and DATE(nv.fecha_hora_creacion)= ?
					 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
					 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
			 ) TABLA
       </Instruccion02>
       <!-- ========== contador DETALLE PRODUCTO opcion TODAS sucursales =============================== -->
       <Instruccion03>
         select count(1) from (
	    		SELECT  
				value(substr(u.logonid,1,2),'RIPLEY')  AS mini , 
				 nv.estado AS estado,
				 nv.correlativo_venta AS nroventa,
				 nv.fecha_hora_creacion AS FECHA_CREACION,
				 nv.fecha_creacion AS FECHA_CONFIRMACION,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), ' ')) AS boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), ' ')) AS fecboleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), ' ')) AS nc,
				 RTRIM (VALUE (VARCHAR (DATE (art.fec_nota_credito)), ' ')) AS fecnc,
				 VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TBANCARIA') as FORMA_PAGO,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS cliente,
				 art.cod_articulo AS COD,
				 art.desc_ripley AS PRODUCTO,
				 art.precio AS PRECIO,
				 art.monto_descuento AS descuento,
				 art.unidades AS UNIDADES, 
				 INTEGER(nv.monto_venta) AS monto_orden, 
				 value(u.logonid,' ')  AS OPERADOR, 
				 substr(CHAR(FECHA_CREACION),21,6) AS mili 
			FROM     articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id 
			WHERE 	 DATE (nv.fecha_hora_creacion) =  ?
				AND nv.correlativo_venta = d.correlativo_venta 
				AND nv.correlativo_venta = art.correlativo_venta 
		) TABLA
       </Instruccion03>
       <!-- ========== exportar DETALLE PROD opcion TODAS sucursal =============================== -->
       <Instruccion04>
			SELECT  
				value(substr(u.logonid,1,2),'RIPLEY')  AS mini , 
				 nv.estado AS estado,
				 suc.TVMAS_GLS_DES  AS sucursal,
				 nv.correlativo_venta AS nroventa,
				 nv.fecha_hora_creacion AS FECHA_CREACION,
				 nv.fecha_creacion AS FECHA_CONFIRMACION,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), ' ')) AS boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), ' ')) AS fecboleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), ' ')) AS nc,
				 RTRIM (VALUE (VARCHAR (DATE (art.fec_nota_credito)), ' ')) AS fecnc,
				 VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TBANCARIA') as FORMA_PAGO,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS cliente,
				 art.cod_articulo AS COD,
				 art.desc_ripley AS PRODUCTO,
				 art.precio AS PRECIO,
				 art.monto_descuento AS descuento,
				 art.unidades AS UNIDADES, 
				 INTEGER(nv.monto_venta) AS monto_orden, 
				 value(u.logonid,' ')  AS OPERADOR, 
				 substr(CHAR(FECHA_CREACION),21,6) AS mili 
			FROM     articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	 DATE (nv.fecha_hora_creacion) =  ?
				 AND nv.correlativo_venta = d.correlativo_venta 
				 AND nv.correlativo_venta = art.correlativo_venta 
				 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
       </Instruccion04>
     </NombreBean>
    
     <NombreBean valor="gestion_28">
       <!-- ========== paginacion TARJETA BANCARIA todas sucursales =============================== -->
       <Instruccion01>
		 SELECT 	nroventa,estado,sucursal,boleta,fecboleta,nc,fecnc,orden,basket,autor,cliente,rut,monto,mili 
		FROM (
			 select  ROW_NUMBER() OVER (order by nv.fecha_hora_creacion) AS C1 
				 ,nv.CORRELATIVO_VENTA AS nroventa 
				 ,nv.ESTADO AS estado 
				 ,suc.TVMAS_GLS_DES  AS sucursal
				 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				 ,nv.CORRELATIVO_VENTA AS orden 
				 ,nv.CORRELATIVO_VENTA AS basket 
				 ,t.CODIGO_AUTORIZADOR AS autor 
				 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				 ,INTEGER(nv.MONTO_VENTA) AS monto 
				 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
			 from     NOTA_VENTA nv,  DESPACHO d, TARJETA_BANCARIA  t ,FETVIR_MAE_SUC suc
			 where    nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
				and DATE(nv.fecha_hora_creacion)= ?
				and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ?

       </Instruccion01>
       <!-- ========== total TARJETA BANCARIA opcion TODAS sucursales =============================== -->
	   <Instruccion02>
     	select count(1) from (
    		 select  
				 nv.CORRELATIVO_VENTA AS nroventa 
				 ,nv.ESTADO AS estado 
				 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				 ,nv.CORRELATIVO_VENTA AS orden 
				 ,nv.CORRELATIVO_VENTA AS basket 
				 ,t.CODIGO_AUTORIZADOR AS autor 
				 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				 ,INTEGER(nv.MONTO_VENTA) AS monto 
				 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
			 from     NOTA_VENTA nv,  DESPACHO d, TARJETA_BANCARIA  t
			 where    nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
			 and DATE(nv.fecha_hora_creacion)= ?
			 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
		) TABLA
       </Instruccion02>
       <!-- ========== exportar TARJETA BANCARIA opcion todas sucursales =============================== -->
       <Instruccion03>
			 select  
				 nv.CORRELATIVO_VENTA AS nroventa 
				 ,nv.ESTADO AS estado 
				 ,suc.TVMAS_GLS_DES  AS sucursal
				 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				 ,nv.CORRELATIVO_VENTA AS orden 
				 ,nv.CORRELATIVO_VENTA AS basket 
				 ,t.CODIGO_AUTORIZADOR AS autor 
				 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				 ,INTEGER(nv.MONTO_VENTA) AS monto 
				 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
			 from     NOTA_VENTA nv,  DESPACHO d, TARJETA_BANCARIA  t ,FETVIR_MAE_SUC suc
			 where    nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
				 and DATE(nv.fecha_hora_creacion)= ?
				 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
				 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
       </Instruccion03>
       <!-- ========== paginacion TARJETA RIPLEY opcion TODAS=============================== -->
       <Instruccion04>
		SELECT 
			nroventa,estado,sucursal,boleta,fecboleta,nc,fecnc,orden,basket,autor,cliente,rut,monto,mili 
		FROM (
	 		select	ROW_NUMBER() OVER (order by nv.fecha_hora_creacion) AS C1, 
				  nv.CORRELATIVO_VENTA AS nroventa 
				 ,nv.ESTADO AS estado 
				 ,suc.TVMAS_GLS_DES  AS sucursal
				 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				 ,nv.CORRELATIVO_VENTA AS orden 
				 ,nv.CORRELATIVO_VENTA AS basket 
				 ,t.CODIGO_AUTORIZADOR AS autor 
				 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				 ,INTEGER(nv.MONTO_VENTA) AS monto 
				 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
		 from    NOTA_VENTA nv,  DESPACHO d, TARJETA_RIPLEY t,FETVIR_MAE_SUC suc 
	 	 where   nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
		 and DATE(nv.fecha_hora_creacion)= ?
		 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
		 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ?
       </Instruccion04>
     </NombreBean>

     <NombreBean valor="gestion_29">
       <!-- ========== tot TARJETA RIPLEY opcion TODAS  =============================== -->
       <Instruccion01>
	     select count(1) from (
     	 select
			nv.CORRELATIVO_VENTA AS nroventa 
			 ,nv.ESTADO AS estado 
			 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
			 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
			 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
			 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
			 ,nv.CORRELATIVO_VENTA AS orden 
			 ,nv.CORRELATIVO_VENTA AS basket 
			 ,t.CODIGO_AUTORIZADOR AS autor 
			 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
			 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
			 ,INTEGER(nv.MONTO_VENTA) AS monto 
			 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
	 	from    NOTA_VENTA nv,  DESPACHO d, TARJETA_RIPLEY t
		where   nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
			and DATE(nv.fecha_hora_creacion)= ?
			and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
     	) TABLA

       </Instruccion01>
       <!-- ========== exportar TARJETA RIPLEY opcion TODAS =============================== -->
	   <Instruccion02>
 		select	
				  nv.CORRELATIVO_VENTA AS nroventa 
				 ,nv.ESTADO AS estado 
				 ,suc.TVMAS_GLS_DES  AS SUCURSAL
				 ,RTRIM(VALUE(CHAR(nv.NUMERO_BOLETA),' ')) AS boleta 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FECHA_BOLETA)),' ')) AS fecboleta 
				 ,RTRIM(VALUE(CHAR(nv.NUM_NOTA_CREDITO),' ')) AS nc 
				 ,RTRIM(VALUE(VARCHAR(DATE(nv.FEC_NOTA_CREDITO)),' ')) AS fecnc 
				 ,nv.CORRELATIVO_VENTA AS orden 
				 ,nv.CORRELATIVO_VENTA AS basket 
				 ,t.CODIGO_AUTORIZADOR AS autor 
				 ,RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente 
				 ,RTRIM(CHAR(nv.RUT_COMPRADOR)) || '-'|| CHAR(nv.DV_COMPRADOR)   AS rut 
				 ,INTEGER(nv.MONTO_VENTA) AS monto 
				 ,substr(CHAR(nv.FECHA_CREACION),21,6) AS mili 
		 from    NOTA_VENTA nv,  DESPACHO d, TARJETA_RIPLEY t,FETVIR_MAE_SUC suc
	 	 where   nv.CORRELATIVO_VENTA = t.CORRELATIVO_VENTA 
		 and DATE(nv.fecha_hora_creacion)= ?
		 and nv.CORRELATIVO_VENTA = d.CORRELATIVO_VENTA 
		 and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
      </Instruccion02>
       <!-- ========== =============================== -->
       <Instruccion03>

       </Instruccion03>
       <!-- ========== =============================== -->
       <Instruccion04>

       </Instruccion04>
     </NombreBean>

	<!--  SMS Reportes REGALOS en GestionTv  / BUSQUEDA POR COD. REGAlO y FECHA-->
	<NombreBean valor="gestion_30">
	
	<!-- Query busqueda por fecha y cod. regalos -->	
       <Instruccion01>
        SELECT 		
		num_sucursal, num_oc, fec_oc, cod_regalo, num_boleta, fec_boleta, num_nota_credito, fec_nota_credito, nom_cliente, rut_cliente, cod_articulo, desc_articulo, unidades, precio, descuento, monto_final, cud, dir_despacho
		FROM (
			SELECT  ROW_NUMBER() OVER (order by nv.fecha_hora_creacion) AS C1, 				 
			
				 nv.numero_sucursal AS num_sucursal,
 			     nv.correlativo_venta AS num_oc,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_creacion)), '-')) AS fec_oc,
				 RTRIM (VALUE (CHAR (nv.CODIGO_REGALO ), '-')) AS cod_regalo,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), '-')) AS num_boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), '-')) AS fec_boleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), '-')) AS num_nota_credito,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fec_nota_credito)), '-')) AS fec_nota_credito,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS nom_cliente,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut_cliente,
				 art.cod_articulo AS cod_articulo,
				 art.desc_ripley AS desc_articulo,
				 art.unidades AS unidades, 
				 art.precio AS precio,
				 art.monto_descuento AS descuento,
				 (art.unidades * (art.precio - art.monto_descuento)) as monto_final,
				 RTRIM (VALUE (CHAR (art.cod_despacho), '-')) AS cud,
				 d.direccion_despacho AS dir_despacho				
				 		 				 
			FROM    articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	nv.correlativo_venta = d.correlativo_venta 
				and nv.correlativo_venta = art.correlativo_venta 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				and nv.CODIGO_REGALO = ?
				and DATE (nv.fecha_creacion) &#0062;= ? 
				and DATE (nv.fecha_creacion) &#0060;= ? 
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ? 	
			     
	   </Instruccion01>
	   <!-- Query Paginacion busqueda por Cod. Regalo y fechas -->
	   <Instruccion02>	     
	   select count(1) from (
	    	SELECT  				 
				 nv.numero_sucursal AS num_sucursal,
 			     nv.correlativo_venta AS num_oc,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_creacion)), '-')) AS fec_oc,
				 RTRIM (VALUE (CHAR (nv.CODIGO_REGALO ), '-')) AS cod_regalo,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), '-')) AS num_boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), '-')) AS fec_boleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), '-')) AS num_nota_credito,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fec_nota_credito)), '-')) AS fec_nota_credito,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS nom_cliente,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut_cliente,
				 art.cod_articulo AS cod_articulo,
				 art.desc_ripley AS desc_articulo,
				 art.unidades AS unidades, 
				 art.precio AS precio,
				 art.monto_descuento AS descuento,
				 (art.unidades * (art.precio - art.monto_descuento)) as monto_final,
				 RTRIM (VALUE (CHAR (art.cod_despacho), '-')) AS cud,
				 d.direccion_despacho AS dir_despacho				
				 		 				 
			FROM    articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	nv.correlativo_venta = d.correlativo_venta 
				and nv.correlativo_venta = art.correlativo_venta 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				and nv.CODIGO_REGALO = ?
				and DATE (nv.fecha_creacion) &#0062;= ? 
				and DATE (nv.fecha_creacion) &#0060;= ? 
		 ) TABLA 
	   </Instruccion02>
	   
	   <!-- Query Exportar archivo excel. busqueda por Cod. Regalos y fecha -->
	   <Instruccion03>	 
	   
	   SELECT 		
				 nv.numero_sucursal AS num_sucursal,
 			     nv.correlativo_venta AS num_oc,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_creacion)), '-')) AS fec_oc,
				 RTRIM (VALUE (CHAR (nv.CODIGO_REGALO ), '-')) AS cod_regalo,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), '-')) AS num_boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), '-')) AS fec_boleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), '-')) AS num_nota_credito,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fec_nota_credito)), '-')) AS fec_nota_credito,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS nom_cliente,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut_cliente,
				 art.cod_articulo AS cod_articulo,
				 art.desc_ripley AS desc_articulo,
				 art.unidades AS unidades, 
				 art.precio AS precio,
				 art.monto_descuento AS descuento,
				 (art.unidades * (art.precio - art.monto_descuento)) as monto_final,
				 RTRIM (VALUE (CHAR (art.cod_despacho), '-')) AS cud,
				 d.direccion_despacho AS dir_despacho
				 					 				 
			FROM    articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	nv.correlativo_venta = d.correlativo_venta 
				and nv.correlativo_venta = art.correlativo_venta 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				and nv.CODIGO_REGALO = ? 
				and DATE (nv.fecha_creacion) &#0062;= ? 
				and DATE (nv.fecha_creacion) &#0060;= ?
				    
	   </Instruccion03>
	   
	   <Instruccion04>	     
	   </Instruccion04>
       

     </NombreBean>
     
     
     <!--  Nuevo Reporte Regalos. SMS  -->
     <NombreBean valor="gestion_31">
	<!--  Query reporte Regalos. Busqueda por codigo de regalo-->
      <Instruccion01>		  
		SELECT 		
		num_sucursal, num_oc, fec_oc, cod_regalo, num_boleta, fec_boleta, num_nota_credito, fec_nota_credito, nom_cliente, rut_cliente, cod_articulo, desc_articulo, unidades, precio, descuento, monto_final, cud, dir_despacho
		FROM (
			SELECT  ROW_NUMBER() OVER (order by nv.fecha_hora_creacion) AS C1, 				 
			
				 nv.numero_sucursal AS num_sucursal,
 			     nv.correlativo_venta AS num_oc,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_creacion)), '-')) AS fec_oc,
				 RTRIM (VALUE (CHAR (nv.CODIGO_REGALO ), '-')) AS cod_regalo,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), '-')) AS num_boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), '-')) AS fec_boleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), '-')) AS num_nota_credito,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fec_nota_credito)), '-')) AS fec_nota_credito,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS nom_cliente,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut_cliente,
				 art.cod_articulo AS cod_articulo,
				 art.desc_ripley AS desc_articulo,
				 art.unidades AS unidades, 
				 art.precio AS precio,
				 art.monto_descuento AS descuento,
				 (art.unidades * (art.precio - art.monto_descuento)) as monto_final,
				 RTRIM (VALUE (CHAR (art.cod_despacho), '-')) AS cud,
				 d.direccion_despacho AS dir_despacho				
				 		 				 
			FROM    articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	nv.correlativo_venta = d.correlativo_venta 
				and nv.correlativo_venta = art.correlativo_venta 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				and nv.CODIGO_REGALO = ? 
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ? 				
      </Instruccion01>
      
      <!--  QUERY PAGINACION, BUSQUEDA POR COD. REGALO -->
      <Instruccion02>      
      	select count(1) from (
	    	SELECT  				 
				 nv.numero_sucursal AS num_sucursal,
 			     nv.correlativo_venta AS num_oc,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_creacion)), '-')) AS fec_oc,
				 RTRIM (VALUE (CHAR (nv.CODIGO_REGALO ), '-')) AS cod_regalo,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), '-')) AS num_boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), '-')) AS fec_boleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), '-')) AS num_nota_credito,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fec_nota_credito)), '-')) AS fec_nota_credito,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS nom_cliente,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut_cliente,
				 art.cod_articulo AS cod_articulo,
				 art.desc_ripley AS desc_articulo,
				 art.unidades AS unidades, 
				 art.precio AS precio,
				 art.monto_descuento AS descuento,
				 (art.unidades * (art.precio - art.monto_descuento)) as monto_final,
				 RTRIM (VALUE (CHAR (art.cod_despacho), '-')) AS cud,
				 d.direccion_despacho AS dir_despacho
					 
				 
			FROM     articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	nv.correlativo_venta = d.correlativo_venta 
				and nv.correlativo_venta = art.correlativo_venta 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				and nv.CODIGO_REGALO = ? 
		 ) TABLA 
		
	  </Instruccion02>
	  
	  <!--  Query Reporte Regalos. Busqueda entre fechas -->	  
      <Instruccion03>
      		 
		SELECT 
			DISTINCT num_sucursal, num_oc, fec_oc, cod_regalo, num_boleta, fec_boleta, num_nota_credito, fec_nota_credito, nom_cliente, rut_cliente, cod_articulo, desc_articulo, unidades, precio, descuento, monto_final, cud, dir_despacho
		FROM (
			SELECT  ROW_NUMBER() OVER (order by nv.fecha_hora_creacion) AS C1, 
				 nv.numero_sucursal AS num_sucursal,
 			     nv.correlativo_venta AS num_oc,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_creacion)), '-')) AS fec_oc,
				 RTRIM (VALUE (CHAR (nv.CODIGO_REGALO ), '-')) AS cod_regalo,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), '-')) AS num_boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), '-')) AS fec_boleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), '-')) AS num_nota_credito,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fec_nota_credito)), '-')) AS fec_nota_credito,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS nom_cliente,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut_cliente,
				 art.cod_articulo AS cod_articulo,
				 art.desc_ripley AS desc_articulo,
				 art.unidades AS unidades, 
				 art.precio AS precio,
				 art.monto_descuento AS descuento,
				 (art.unidades * (art.precio - art.monto_descuento)) as monto_final,
				 RTRIM (VALUE (CHAR (art.cod_despacho), '-')) AS cud,
				 d.direccion_despacho AS dir_despacho
				 					
			FROM     articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	DATE (nv.fecha_creacion) &#0062;= ? 
				and DATE (nv.fecha_creacion) &#0060;= ?
				and nv.CODIGO_REGALO != 0
				and nv.correlativo_venta = d.correlativo_venta 
				and nv.correlativo_venta = art.correlativo_venta 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ? 	
		
      </Instruccion03>

      <!--  QUERY PAGINACION, BUSQUEDA ENTRE FECHAS -->
      <Instruccion04>                     
      	 
		    SELECT count(1) from (
	    		SELECT  
				 nv.numero_sucursal AS num_sucursal,
 			     nv.correlativo_venta AS num_oc,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_creacion)), '-')) AS fec_oc,
				 RTRIM (VALUE (CHAR (nv.CODIGO_REGALO ), '-')) AS cod_regalo,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), '-')) AS num_boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), '-')) AS fec_boleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), '-')) AS num_nota_credito,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fec_nota_credito)), '-')) AS fec_nota_credito,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS nom_cliente,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut_cliente,
				 art.cod_articulo AS cod_articulo,
				 art.desc_ripley AS desc_articulo,
				 art.unidades AS unidades, 
				 art.precio AS precio,
				 art.monto_descuento AS descuento,
				 (art.unidades * (art.precio - art.monto_descuento)) as monto_final,
				 RTRIM (VALUE (CHAR (art.cod_despacho), '-')) AS cud,
				 d.direccion_despacho AS dir_despacho
				 		
			FROM    articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id 
			WHERE 	DATE (nv.fecha_creacion) &#0062;= ? 
				and DATE (nv.fecha_creacion) &#0060;= ?
				and nv.CODIGO_REGALO != 0
				and nv.correlativo_venta = d.correlativo_venta 
				and nv.correlativo_venta = art.correlativo_venta 
			) TABLA
		
	  </Instruccion04>
    </NombreBean>
    

    <!-- **** QUERY EXPORTAR ARCHIVO EXCEL - REPORTE REGALOS ***** -->
    
    <NombreBean valor="gestion_32">	  
      <Instruccion01>		  
			SELECT 		
				 nv.numero_sucursal AS num_sucursal,
 			     nv.correlativo_venta AS num_oc,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_creacion)), '-')) AS fec_oc,
				 RTRIM (VALUE (CHAR (nv.CODIGO_REGALO ), '-')) AS cod_regalo,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), '-')) AS num_boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), '-')) AS fec_boleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), '-')) AS num_nota_credito,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fec_nota_credito)), '-')) AS fec_nota_credito,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS nom_cliente,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut_cliente,
				 art.cod_articulo AS cod_articulo,
				 art.desc_ripley AS desc_articulo,
				 art.unidades AS unidades, 
				 art.precio AS precio,
				 art.monto_descuento AS descuento,
				 (art.unidades * (art.precio - art.monto_descuento)) as monto_final,
				 RTRIM (VALUE (CHAR (art.cod_despacho), '-')) AS cud,
				 d.direccion_despacho AS dir_despacho
				 					 				 
			FROM    articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	nv.correlativo_venta = d.correlativo_venta 
				and nv.correlativo_venta = art.correlativo_venta 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				and nv.CODIGO_REGALO = ? 

      </Instruccion01>

      <Instruccion02>      
	</Instruccion02>
	  
	  <!--  Query Reporte Regalos. Busqueda entre fechas -->	  
      <Instruccion03>
    		SELECT 
				 nv.numero_sucursal AS num_sucursal,
 			     nv.correlativo_venta AS num_oc,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_creacion)), '-')) AS fec_oc,
				 RTRIM (VALUE (CHAR (nv.CODIGO_REGALO ), '-')) AS cod_regalo,
				 RTRIM (VALUE (CHAR (nv.numero_boleta), '-')) AS num_boleta,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fecha_boleta)), '-')) AS fec_boleta,
				 RTRIM (VALUE (CHAR (art.num_nota_credito), '-')) AS num_nota_credito,
				 RTRIM (VALUE (VARCHAR (DATE (nv.fec_nota_credito)), '-')) AS fec_nota_credito,
				 RTRIM (SUBSTR(d.nombre_cliente || ' ' || d.apellido_pat_cliente || ' ' || d.apellido_mat_cliente,1,50)) AS nom_cliente,
				 RTRIM (CHAR (nv.rut_comprador)) || '-' || CHAR (nv.dv_comprador) AS rut_cliente,
				 art.cod_articulo AS cod_articulo,
				 art.desc_ripley AS desc_articulo,
				 art.unidades AS unidades, 
				 art.precio AS precio,
				 art.monto_descuento AS descuento,
				 (art.unidades * (art.precio - art.monto_descuento)) as monto_final,
				 RTRIM (VALUE (CHAR (art.cod_despacho), '-')) AS cud,
				 d.direccion_despacho AS dir_despacho
				 							
			FROM     articulo_venta art,despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
			WHERE 	DATE (nv.fecha_creacion) &#0062;= ? 
				and DATE (nv.fecha_creacion) &#0060;= ?
				and nv.CODIGO_REGALO != 0
				and nv.correlativo_venta = d.correlativo_venta 
				and nv.correlativo_venta = art.correlativo_venta 
				and nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
					
      </Instruccion03>

      <Instruccion04>                          
      
	  </Instruccion04>
    </NombreBean>
    
    <!--  Query Reporte Stock TVI - BigTicket -->
    <NombreBean valor="gestion_34">	  
	  <!-- INTRUCCION QUE ELIMINA DATOS DE TABLA EN 'MEMORIA' STOCK_BT EN DB2 -->    
      <Instruccion01>		  
			<!-- TRUNCATE TABLE STK_BIGTICKET2 -->
			DELETE from "DB2INST1"."FETVIR_MAE_STK_BTK"

      </Instruccion01>      

	<!-- Obtiene productos de la TV, desde BigTicket -->
      <Instruccion02> 
      <!--  Query ORIGINAL
      		  select distinct
                     bs.nro_loc_bod || '  ' || blb.nombre_loc_bod as nro_loc_bod,
                     bp.codigo_vta as codigo_vta, 
                     bp.cod_depto as cod_depto,
                     bs.inventario as inventario,
                     bp.cod_linea as cod_linea,
                     bp.cod_sublinea as cod_sublinea,
                     bs.disponible as disponible
              from bigt_productos bp, bigt_stock bs, bigt_local_bodega blb
              where bp.indicador_int &#0062; 0
                and bs.nro_loc_bod = lobtck_fun_prd_bod(bp.codigo_vta)
                and bs.nro_loc_bod = blb.nro_loc_bod
                and bs.codigo_vta  = bp.codigo_vta
              order by 1, 2
         -->          
             
         SELECT nro_loc_bod,codigo_vta,cod_depto,sum(disponible) as disponible,sum(reservado) as inventario
			FROM (SELECT 
			               bs.nro_loc_bod || '  ' || blb.nombre_loc_bod as nro_loc_bod,
			               bp.codigo_vta as codigo_vta, 
			               bp.cod_depto as cod_depto,
			               bs.disponible as disponible,
						   0 as reservado
						   
	              FROM 	   bigt_productos bp, bigt_stock bs, bigt_local_bodega blb
	              
	              WHERE    bp.indicador_int &#0062; 0
	                and    bs.nro_loc_bod = lobtck_fun_prd_bod(bp.codigo_vta)
	                and    bs.nro_loc_bod = blb.nro_loc_bod
	                and    bs.codigo_vta  = bp.codigo_vta
					and    bs.inventario = 0
					
				  UNION 
				  
				  SELECT 
						   bs.nro_loc_bod || '  ' || blb.nombre_loc_bod as nro_loc_bod,
		                   bp.codigo_vta as codigo_vta, 
		                   bp.cod_depto as cod_depto,
						   0 as disponible,
						   bs.disponible as reservado
				  FROM	   bigt_productos bp, bigt_stock bs, bigt_local_bodega blb
				  
	              WHERE    bp.indicador_int &#0062; 0
	                and    bs.nro_loc_bod = lobtck_fun_prd_bod(bp.codigo_vta)
	                and    bs.nro_loc_bod = blb.nro_loc_bod
	                and    bs.codigo_vta  = bp.codigo_vta
					and    bs.inventario = 1				
					order by 1, 2)
			GROUP BY nro_loc_bod,codigo_vta,cod_depto
			 
	  </Instruccion02>
      <Instruccion03>
		
      </Instruccion03>
      
      <Instruccion04>
		
      </Instruccion04>
    </NombreBean>
    
    
    <!--  QUERY'S DE FILTRO 'STOCK INTERNET' PARA TV -->
    <NombreBean valor="gestion_35">	  
	  <!-- QUERY QUE OBTIENE PRODUCTOS CON STOCK EN TV  -->    
       <Instruccion01>       
       SELECT 
			SKU, DEPTO, BODEGA, DISP, RESV, STOCK_TVI, diferencia
		FROM (
			SELECT  ROW_NUMBER() OVER (order by c.partnumber) AS C1, 
					c.partnumber AS SKU, 
			        sb.TVMSB_COD_DPTO AS DEPTO, 
			        sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			        sb.TVMSB_DIS_PROD AS DISP,
			        sb.TVMSB_INV_PROD AS RESV,
			        INTEGER(i.quantity) AS STOCK_TVI,
			        (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM    catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE   c.catentry_id = i.catentry_id 
			  AND   sb.TVMSB_COD_VTA =  c.partnumber
		   	  AND	i.quantity &#0062; 0
		   	  AND   c.partnumber LIKE ?			
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ? 	
			 	
       </Instruccion01>      
	  <!-- QUERY QUE OBTIENE PRODUCTOS SIN STOCK EN TV  -->    
       <Instruccion02>
	 		SELECT 
			SKU, DEPTO, BODEGA, DISP, RESV, STOCK_TVI, diferencia
		FROM (
			SELECT  ROW_NUMBER() OVER (order by c.partnumber) AS C1, 
					c.partnumber AS SKU, 
			        sb.TVMSB_COD_DPTO AS DEPTO, 
			        sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			        sb.TVMSB_DIS_PROD AS DISP,
			        sb.TVMSB_INV_PROD AS RESV,
			        INTEGER(i.quantity) AS STOCK_TVI,
			        (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM    catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE   c.catentry_id = i.catentry_id 
			  AND   sb.TVMSB_COD_VTA =  c.partnumber
		   	  AND	i.quantity = 0
		  	  AND   c.partnumber LIKE ?
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ? 	
 		
       </Instruccion02>
       <!-- QUERY OBTIENE TODOS LOS PRODUCTOS EN TV  -->
       <Instruccion03>
	 	SELECT 
			SKU, DEPTO, BODEGA, DISP, RESV, STOCK_TVI, diferencia
		FROM (
			SELECT  ROW_NUMBER() OVER (order by c.partnumber) AS C1, 
					c.partnumber AS SKU, 
			        sb.TVMSB_COD_DPTO AS DEPTO, 
			        sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			        sb.TVMSB_DIS_PROD AS DISP,
			        sb.TVMSB_INV_PROD AS RESV,
			        INTEGER(i.quantity) AS STOCK_TVI,
			        (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM    catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE   c.catentry_id = i.catentry_id 
			  AND   sb.TVMSB_COD_VTA =  c.partnumber
  		   	  AND   c.partnumber LIKE ? 
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ? 	   			 
       </Instruccion03>       

       <Instruccion04>
       </Instruccion04>       
    </NombreBean>

	<!--  QUERY DE PAGINACION, FILTRO STOCK INTERNET -->
    <NombreBean valor="gestion_36">	  
	  <!-- QUERY QUE OBTIENE PRODUCTOS CON STOCK EN TVI  -->    
       <Instruccion01>
       
       SELECT count(1) from (
			SELECT  
				   	c.partnumber AS SKU, 
			        sb.TVMSB_COD_DPTO AS DEPTO, 
			        sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			        sb.TVMSB_DIS_PROD AS DISP,
			        sb.TVMSB_INV_PROD AS RESV,
			        INTEGER(i.quantity) AS STOCK_TVI,
			        (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM    catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE   c.catentry_id = i.catentry_id 
			  AND   sb.TVMSB_COD_VTA =  c.partnumber
		   	  AND	i.quantity &#0062; 0
  		   	  AND   c.partnumber LIKE ?
		   	  
		) TABLA
				 	  
       </Instruccion01>      
       <!-- QUERY QUE OBTIENE PRODUCTOS SIN STOCK EN TVI  -->    
       <Instruccion02>
       	 SELECT count(1) from (
			SELECT  
				   	c.partnumber AS SKU, 
			        sb.TVMSB_COD_DPTO AS DEPTO, 
			        sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			        sb.TVMSB_DIS_PROD AS DISP,
			        sb.TVMSB_INV_PROD AS RESV,
			        INTEGER(i.quantity) AS STOCK_TVI,
			        (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM    catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE   c.catentry_id = i.catentry_id 
			  AND   sb.TVMSB_COD_VTA =  c.partnumber
		   	  AND	i.quantity = 0				
  		   	  AND   c.partnumber LIKE ?
		) TABLA				  
       </Instruccion02>

       <Instruccion03>
	 	SELECT count(1) from (
			SELECT  
				   	c.partnumber AS SKU, 
			        sb.TVMSB_COD_DPTO AS DEPTO, 
			        sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			        sb.TVMSB_DIS_PROD AS DISP,
			        sb.TVMSB_INV_PROD AS RESV,
			        INTEGER(i.quantity) AS STOCK_TVI,
			        (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM    catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE   c.catentry_id = i.catentry_id 
			  AND   sb.TVMSB_COD_VTA =  c.partnumber
  		   	  AND   c.partnumber LIKE ?
		) TABLA			  
       </Instruccion03>
       
       <Instruccion04>

       </Instruccion04>       
    </NombreBean>
    
       
    <!--  QUERY'S DE FILTRO 'DIFERENCIA STOCK BIGTICKET - TVI' 
          diferencia = stock_TVI - (disponible_bigTicket + reservado_internet_bigTicket) -->
    
    <NombreBean valor="gestion_37">	  
	  <!-- QUERY QUE OBTIENE PRODUCTOS CON DIFERENCIA DE STOCK ENTRE BIGTICKET Y TVI  -->    
       <Instruccion01>
       SELECT 
			SKU, DEPTO, BODEGA, DISP, RESV, STOCK_TVI, diferencia
		FROM (
				SELECT  ROW_NUMBER() OVER (order by c.partnumber) AS C1, 
						 c.partnumber AS SKU, 
         			 	 sb.TVMSB_COD_DPTO AS DEPTO, 
			          	 sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			         	 sb.TVMSB_DIS_PROD AS DISP,
			         	 sb.TVMSB_INV_PROD AS RESV,
			         	 INTEGER(i.quantity) AS STOCK_TVI,
			         	 (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
				FROM     catentry c, inventory i, FETVIR_MAE_STK_BTK sb
				WHERE    c.catentry_id = i.catentry_id 
			 	 AND     sb.TVMSB_COD_VTA =  c.partnumber
			 	 AND    (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) &#0062; 0 
    		   	 AND   c.partnumber LIKE ? 				
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ? 	   			 
				  
	 	
			  
       </Instruccion01>      
       
	  <!-- QUERY QUE OBTIENE PRODUCTOS SIN DIFERENCIAS DE STOCK ENTRE BIGTICKET Y TV  -->    
       <Instruccion02>
       SELECT 
			SKU, DEPTO, BODEGA, DISP, RESV, STOCK_TVI, diferencia
		FROM (
				SELECT  ROW_NUMBER() OVER (order by c.partnumber) AS C1, 
						 c.partnumber AS SKU, 
         			 	 sb.TVMSB_COD_DPTO AS DEPTO, 
			          	 sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			         	 sb.TVMSB_DIS_PROD AS DISP,
			         	 sb.TVMSB_INV_PROD AS RESV,
			         	 INTEGER(i.quantity) AS STOCK_TVI,
			         	 (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
				FROM     catentry c, inventory i, FETVIR_MAE_STK_BTK sb
				WHERE    c.catentry_id = i.catentry_id 
			 	 AND     sb.TVMSB_COD_VTA =  c.partnumber
			 	 AND    (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) = 0 
    		   	 AND     c.partnumber LIKE ?								
		) TABLA
		WHERE TABLA.C1 &#0062; ?
		AND TABLA.C1 &#0060; ? 	   			 
 		
       </Instruccion02>
       <!-- QUERY OBTIENE LOS PRODUCTOS CON/SIN DIFERENCIA ENTRE BIGTICKET  -->
       <Instruccion03>
	       SELECT 
				SKU, DEPTO, BODEGA, DISP, RESV, STOCK_TVI, diferencia
			FROM (
					SELECT  ROW_NUMBER() OVER (order by c.partnumber) AS C1, 
						 	 c.partnumber AS SKU, 
	         			 	 sb.TVMSB_COD_DPTO AS DEPTO, 
				          	 sb.TVMSB_NRO_LOC_BOD AS BODEGA,
				         	 sb.TVMSB_DIS_PROD AS DISP,
				         	 sb.TVMSB_INV_PROD AS RESV,
				         	 INTEGER(i.quantity) AS STOCK_TVI,
				         	 (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
					FROM     catentry c, inventory i, FETVIR_MAE_STK_BTK sb
					WHERE    c.catentry_id = i.catentry_id 
				 	 AND     sb.TVMSB_COD_VTA =  c.partnumber
      			   	 AND   c.partnumber LIKE ?				
			) TABLA
			WHERE TABLA.C1 &#0062; ?
			AND TABLA.C1 &#0060; ? 	   			        
		
		</Instruccion03>
       
       <Instruccion04>

       </Instruccion04>       
    </NombreBean>
    
  	<!--  QUERY DE PAGINACION, FILTRO 'DIF. STOCK BT/TVI' -->
    <NombreBean valor="gestion_38">	  
	   <!-- QUERY QUE OBTIENE PRODUCTOS CON DIFERENCIA DE STOCK ENTRE BT-TVI  -->    
       <Instruccion01>     
       
       SELECT count(1) from (
			SELECT   c.partnumber AS SKU, 
         			 sb.TVMSB_COD_DPTO AS DEPTO, 
			         sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			         sb.TVMSB_DIS_PROD AS DISP,
			         sb.TVMSB_INV_PROD AS RESV,
			         INTEGER(i.quantity) AS STOCK_TVI,
			         (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM     catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE    c.catentry_id = i.catentry_id 
			  AND    sb.TVMSB_COD_VTA =  c.partnumber
			  AND    (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) &#0062; 0 		
    		  AND   c.partnumber LIKE ?						   	  
		) TABLA		  
	 	  
       </Instruccion01>      
       <!-- QUERY QUE OBTIENE PRODUCTOS SIN DIFERENCIA ENTRE TVI-BT  -->    
       <Instruccion02>
       	 SELECT count(1) from (
			SELECT   c.partnumber AS SKU, 
         			 sb.TVMSB_COD_DPTO AS DEPTO, 
			         sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			         sb.TVMSB_DIS_PROD AS DISP,
			         sb.TVMSB_INV_PROD AS RESV,
			         INTEGER(i.quantity) AS STOCK_TVI,
			         (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM     catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE    c.catentry_id = i.catentry_id 
			  AND    sb.TVMSB_COD_VTA =  c.partnumber
			  AND    (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) = 0 		
    		  AND   c.partnumber LIKE ?						   	  
		) TABLA					  
       </Instruccion02>
       
	<!-- QUERY QUE OBTIENE TODOS LOS PRODUCTOS ENTRE TVI - BT  -->    
       <Instruccion03>
	 	SELECT count(1) from (
			SELECT   c.partnumber AS SKU, 
         			 sb.TVMSB_COD_DPTO AS DEPTO, 
			         sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			         sb.TVMSB_DIS_PROD AS DISP,
			         sb.TVMSB_INV_PROD AS RESV,
			         INTEGER(i.quantity) AS STOCK_TVI,
			         (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM     catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE    c.catentry_id = i.catentry_id 
			  AND    sb.TVMSB_COD_VTA =  c.partnumber
		   	  AND    c.partnumber LIKE ? 				
		) TABLA				  
       </Instruccion03>
       
       <Instruccion04>

       </Instruccion04>       
    </NombreBean>
    
    <!--  QUERY PARA EXPORTAR REPORTE FILTRO 'STOCK INTERNET' -->
    <NombreBean valor="gestion_39">	  
	   <!-- QUERY EXPORTAR REPORTE PRODUCTOS CON STOCK EN TV  -->    
       <Instruccion01>     
     		SELECT  
					c.partnumber AS SKU, 
			        sb.TVMSB_COD_DPTO AS DEPTO, 
			        sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			        sb.TVMSB_DIS_PROD AS DISP,
			        sb.TVMSB_INV_PROD AS RESV,
			        INTEGER(i.quantity) AS STOCK_TVI,
			        (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM    catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE   c.catentry_id = i.catentry_id 
			  AND   sb.TVMSB_COD_VTA =  c.partnumber
		   	  AND	i.quantity &#0062; 0
		   	  AND    c.partnumber LIKE ? 				
      
	 	  
       </Instruccion01>      
	   <!-- QUERY EXPORTAR REPORTE PRODUCTOS SIN STOCK EN TV  -->    
       <Instruccion02>
           	SELECT  
					c.partnumber AS SKU, 
			        sb.TVMSB_COD_DPTO AS DEPTO, 
			        sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			        sb.TVMSB_DIS_PROD AS DISP,
			        sb.TVMSB_INV_PROD AS RESV,
			        INTEGER(i.quantity) AS STOCK_TVI,
			        (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM    catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE   c.catentry_id = i.catentry_id 
			  AND   sb.TVMSB_COD_VTA =  c.partnumber
		   	  AND	i.quantity = 0
		   	  AND    c.partnumber LIKE ?
       </Instruccion02>
       
		<!-- QUERY EXPORTAR REPORTE TODOS LOS PRODUCTOS EN TVI   -->    
       <Instruccion03>
           	SELECT  
					c.partnumber AS SKU, 
			        sb.TVMSB_COD_DPTO AS DEPTO, 
			        sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			        sb.TVMSB_DIS_PROD AS DISP,
			        sb.TVMSB_INV_PROD AS RESV,
			        INTEGER(i.quantity) AS STOCK_TVI,
			        (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
			FROM    catentry c, inventory i, FETVIR_MAE_STK_BTK sb
			WHERE   c.catentry_id = i.catentry_id 
			  AND   sb.TVMSB_COD_VTA =  c.partnumber
			  AND    c.partnumber LIKE ?
       </Instruccion03>
       
       <Instruccion04>

       </Instruccion04>       
    </NombreBean>
    
    <!--  QUERY PARA EXPORTAR REPORTE FILTRO 'DIF. STOCK BT/TVI' -->
    <NombreBean valor="gestion_40">	  
	   <!-- QUERY EXPORTAR STOCK CON DIFERENCIA ENTRE TV - BT  -->    
       <Instruccion01>     
     			SELECT  
						 c.partnumber AS SKU, 
         			 	 sb.TVMSB_COD_DPTO AS DEPTO, 
			          	 sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			         	 sb.TVMSB_DIS_PROD AS DISP,
			         	 sb.TVMSB_INV_PROD AS RESV,
			         	 INTEGER(i.quantity) AS STOCK_TVI,
			         	 (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
				FROM     catentry c, inventory i, FETVIR_MAE_STK_BTK sb
				WHERE    c.catentry_id = i.catentry_id 
			 	 AND     sb.TVMSB_COD_VTA =  c.partnumber
			 	 AND     (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) &#0062; 0 
    		   	 AND     c.partnumber LIKE ? 	
	 	  
       </Instruccion01> 
            
	   <!-- QUERY EXPORTAR SIN DIFERENCIA DE STOCK ENTRE TV Y BT  -->    
       <Instruccion02>
           	SELECT  
						 c.partnumber AS SKU, 
         			 	 sb.TVMSB_COD_DPTO AS DEPTO, 
			          	 sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			         	 sb.TVMSB_DIS_PROD AS DISP,
			         	 sb.TVMSB_INV_PROD AS RESV,
			         	 INTEGER(i.quantity) AS STOCK_TVI,
			         	 (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
				FROM     catentry c, inventory i, FETVIR_MAE_STK_BTK sb
				WHERE    c.catentry_id = i.catentry_id 
			 	 AND     sb.TVMSB_COD_VTA =  c.partnumber
			 	 AND     (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) = 0 
    		   	 AND     c.partnumber LIKE ? 
       </Instruccion02>
       
		<!-- QUERY EXPORTAR TODOS LOS STOCK    -->    
       <Instruccion03>
				SELECT  
						 c.partnumber AS SKU, 
         			 	 sb.TVMSB_COD_DPTO AS DEPTO, 
			          	 sb.TVMSB_NRO_LOC_BOD AS BODEGA,
			         	 sb.TVMSB_DIS_PROD AS DISP,
			         	 sb.TVMSB_INV_PROD AS RESV,
			         	 INTEGER(i.quantity) AS STOCK_TVI,
			         	 (INTEGER(i.quantity) - (sb.TVMSB_DIS_PROD + sb.TVMSB_INV_PROD)) as diferencia
				FROM     catentry c, inventory i, FETVIR_MAE_STK_BTK sb
				WHERE    c.catentry_id = i.catentry_id 
			 	 AND     sb.TVMSB_COD_VTA =  c.partnumber
			 	 AND     c.partnumber LIKE ? 
       </Instruccion03>
       
       <Instruccion04>

       </Instruccion04>       
    </NombreBean>
    
    <!-- REPORTE SAV -->
    <NombreBean valor="gestion_41">

      <Instruccion01>

             select count(1) from (

                    SELECT 

                    FETVIR_MAE_REG_SOL.TVMRS_GLS_RUN as rut,

			                    FETVIR_MAE_REG_SOL.TVMRS_GLS_NOM as nombre,

                                  FETVIR_MAE_REG_SOL.TVMRS_GLS_MAI as email,

                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_FON), '-')) as fono,

                                  FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL as fecha_sol,

                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_CAN_SOL), '-')) as nro_can_sol,

                                  RTRIM (VALUE (VARCHAR (FETVIR_MAE_SAV.TVMSV_GLS_DES), '-')) as GLS_SAV,
                                  
                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_MNT_SAV ), '-')) as MNT_SAV,
                                  
                                  FETVIR_MAE_REG_SOL.TVMRS_FCH_VGN as FCH_VGN


                    FROM FETVIR_MAE_REG_SOL, FETVIR_MAE_SAV 

                    
                    WHERE FETVIR_MAE_REG_SOL.TVMRS_COD_SAV = FETVIR_MAE_SAV.TVMSV_COD_SAV_K and

			        DATE(FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL) = ? 
			
                    
             )tabla            

       </Instruccion01>

       <!-- ========== total TARJETA BANCARIA opcion TODAS sucursales =============================== -->

       <Instruccion02>

       select count(1) from (

                    SELECT 

                    RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_GLS_RUN), '-'))  as rut,

                                  FETVIR_MAE_REG_SOL.TVMRS_GLS_RUN as rut,

			                      FETVIR_MAE_REG_SOL.TVMRS_GLS_NOM as nombre,

                                  FETVIR_MAE_REG_SOL.TVMRS_GLS_MAI as email,

                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_FON), '-')) as fono,

                                  FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL as fecha_sol,

                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_CAN_SOL), '-')) as nro_can_sol,

                                  RTRIM (VALUE (VARCHAR (FETVIR_MAE_SAV.TVMSV_GLS_DES), '-')) as GLS_SAV,
                                  
                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_MNT_SAV ), '-')) as MNT_SAV,
                                  
                                  FETVIR_MAE_REG_SOL.TVMRS_FCH_VGN as FCH_VGN

                    FROM FETVIR_MAE_REG_SOL, FETVIR_MAE_SAV 

                    WHERE FETVIR_MAE_REG_SOL.TVMRS_COD_SAV = FETVIR_MAE_SAV.TVMSV_COD_SAV_K and

			        DATE(FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL) = ? AND 
			
			        FETVIR_MAE_REG_SOL.TVMRS_COD_SAV = ?
			                    
                    
				)tabla 

       </Instruccion02>

       <!-- ========== exportar TARJETA BANCARIA opcion todas sucursales =============================== -->

       <Instruccion03>

                    SELECT rut,nombre,email,fono,fecha_sol,nro_can_sol,GLS_SAV,MNT_SAV,FCH_VGN

                    FROM (SELECT  ROW_NUMBER() OVER (order by TVMRS_FCH_SOL) AS C1,

                                  FETVIR_MAE_REG_SOL.TVMRS_GLS_RUN as rut,

			                      FETVIR_MAE_REG_SOL.TVMRS_GLS_NOM as nombre,

                                  FETVIR_MAE_REG_SOL.TVMRS_GLS_MAI as email,

                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_FON), '-')) as fono,

                                  FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL as fecha_sol,

                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_CAN_SOL), '-')) as nro_can_sol,

                                  RTRIM (VALUE (VARCHAR (FETVIR_MAE_SAV.TVMSV_GLS_DES), '-')) as GLS_SAV,
                                  
                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_MNT_SAV ), '-')) as MNT_SAV,
                                  
                                  FETVIR_MAE_REG_SOL.TVMRS_FCH_VGN as FCH_VGN


                                FROM FETVIR_MAE_REG_SOL, FETVIR_MAE_SAV 

                                WHERE FETVIR_MAE_REG_SOL.TVMRS_COD_SAV = FETVIR_MAE_SAV.TVMSV_COD_SAV_K and

			                    DATE(FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL) = ? AND 
			
			                    FETVIR_MAE_REG_SOL.TVMRS_COD_SAV = ?

                    )TABLA

             WHERE TABLA.C1 &#0062; ?

             AND TABLA.C1 &#0060; ?

       </Instruccion03>

       <!-- ========== paginacion TARJETA RIPLEY opcion TODAS=============================== -->

       <Instruccion04>

                    SELECT rut,nombre,email,fono,fecha_sol,nro_can_sol,GLS_SAV,MNT_SAV,FCH_VGN

                    FROM (SELECT  ROW_NUMBER() OVER (order by TVMRS_FCH_SOL) AS C1,

                                FETVIR_MAE_REG_SOL.TVMRS_GLS_RUN as rut,

			                    FETVIR_MAE_REG_SOL.TVMRS_GLS_NOM as nombre,

                                  FETVIR_MAE_REG_SOL.TVMRS_GLS_MAI as email,

                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_FON), '-')) as fono,

                                  FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL as fecha_sol,

                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_CAN_SOL), '-')) as nro_can_sol,

                                  RTRIM (VALUE (VARCHAR (FETVIR_MAE_SAV.TVMSV_GLS_DES), '-')) as GLS_SAV,
                                  
                                  RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_MNT_SAV ), '-')) as MNT_SAV,
                                  
                                  FETVIR_MAE_REG_SOL.TVMRS_FCH_VGN as FCH_VGN

								
								FROM FETVIR_MAE_REG_SOL, FETVIR_MAE_SAV 

                                WHERE FETVIR_MAE_REG_SOL.TVMRS_COD_SAV = FETVIR_MAE_SAV.TVMSV_COD_SAV_K and

			                    DATE(FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL) = ?               			
			                    

                    )TABLA

             WHERE TABLA.C1 &#0062; ?

             AND TABLA.C1 &#0060; ?     

       </Instruccion04>

      

      
     </NombreBean>
     
    <!--  Opciones SAV -->

      <NombreBean valor="gestion_42">
      
      <Instruccion01>
      SELECT TVMSV_COD_SAV_K, TVMSV_GLS_DES FROM DB2INST1.FETVIR_MAE_SAV f
      </Instruccion01>

	<!-- Exportar excel, con filtro SAV - SIN SAV -->
       <Instruccion02>
       
	       SELECT  

              FETVIR_MAE_REG_SOL.TVMRS_GLS_RUN as rut,

			  FETVIR_MAE_REG_SOL.TVMRS_GLS_NOM as nombre,

              FETVIR_MAE_REG_SOL.TVMRS_GLS_MAI as email,

              RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_FON), '-')) as fono,

              FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL as fecha_sol,

              RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_CAN_SOL), '-')) as nro_can_sol,

              RTRIM (VALUE (VARCHAR (FETVIR_MAE_SAV.TVMSV_GLS_DES), '-')) as GLS_SAV,
             
              RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_MNT_SAV ), '-')) as MNT_SAV,
              
              FETVIR_MAE_REG_SOL.TVMRS_FCH_VGN as FCH_VGN


           FROM FETVIR_MAE_REG_SOL, FETVIR_MAE_SAV 

           WHERE FETVIR_MAE_REG_SOL.TVMRS_COD_SAV = FETVIR_MAE_SAV.TVMSV_COD_SAV_K and

		     DATE(FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL) = ? AND 
   		     
   		     FETVIR_MAE_REG_SOL.TVMRS_COD_SAV = ?
       

      </Instruccion02>
	<!-- Exportar excel, con filtro FECHA-->
       <Instruccion03>
       SELECT  

              FETVIR_MAE_REG_SOL.TVMRS_GLS_RUN as rut,

			  FETVIR_MAE_REG_SOL.TVMRS_GLS_NOM as nombre,

              FETVIR_MAE_REG_SOL.TVMRS_GLS_MAI as email,

              RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_FON), '-')) as fono,

              FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL as fecha_sol,

              RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_NRO_CAN_SOL), '-')) as nro_can_sol,

              RTRIM (VALUE (VARCHAR (FETVIR_MAE_SAV.TVMSV_GLS_DES), '-')) as GLS_SAV,
             
              RTRIM (VALUE (CHAR (FETVIR_MAE_REG_SOL.TVMRS_MNT_SAV ), '-')) as MNT_SAV,
              
              FETVIR_MAE_REG_SOL.TVMRS_FCH_VGN as FCH_VGN


           FROM FETVIR_MAE_REG_SOL, FETVIR_MAE_SAV 

           WHERE FETVIR_MAE_REG_SOL.TVMRS_COD_SAV = FETVIR_MAE_SAV.TVMSV_COD_SAV_K and

		     DATE(FETVIR_MAE_REG_SOL.TVMRS_FCH_SOL) = ?    		     

       </Instruccion03>

       <!-- ========== paginacion TARJETA RIPLEY opcion TODAS=============================== -->

       <Instruccion04>
      </Instruccion04>
      </NombreBean>


	<!--  AGA 20071010 - ACTIVACION GCP -->
	<NombreBean valor="gestion_43">
      <!-- Validacion Activacion GCP - Estado de tarjeta, monto, etc -->
      <Instruccion01>
		SELECT 
				NVL(valor,0) AS valor, 
			   	NVL(CXTSK_flg_tip_vlr,0) as flag_monto_cero, 
			   	NVL(status,0) as estado, 
		       	NVL(to_char(CXTSK_FCH_FIN_VIG,'yyyymmdd'),0) as fin_vigencia, 
		       	to_char(sysdate,'yyyymmdd') as fecha_hoy		       
		FROM 	
				credi_tr_stock
				
		WHERE 
				codigo = ?
				
      </Instruccion01>
	
	<!--  Validacin GCP - monto minimo de activacin -->
       <Instruccion02>
		SELECT 
			tcpa_valor as min_monto_actv
	   	FROM
	   		tc_parametros	   		
	   	WHERE 
	   		tcpa_nombre like 'MONTO MINIMO T.REGALO'
      </Instruccion02>
	
	<!-- Obtiene abono original de la tarjeta de regalo -->
       <Instruccion03>
       SELECT 
       		NVL (tctx_abono_orig, 0) AS pesosdisp
		FROM 
        	tc_trxs_cta_cte
        WHERE 
            tcdc_rut_clte       	= ?
       AND 
       		tcdc_tarjeta        = 70
       AND 
       		tcdc_producto       = 57
       </Instruccion03>
      <!--  obtengo saldo tarjeta  -->
       <Instruccion04>
       	SELECT		   
		   	NVL (tcsa_disponible, 0) AS montodisp
		FROM
		 	tc_saldos_clientes
		WHERE
		 	tcdc_rut_clte = ?
		
      </Instruccion04>
      
      </NombreBean>
	
   	<!--  AGA 20071022 - ACTIVACION GCP -->
	<NombreBean valor="gestion_44">
      <!-- Validacion Activacion GCP - Estado de tarjeta, monto, etc -->
      <Instruccion01>
		SELECT 
			tcpa_valor as monto_maximo
		FROM
			tc_parametros
	    WHERE 
	   		tcpa_nombre like 'MONTO MAXIMO T.REGALO'
      </Instruccion01>
	
       <!-- PL activacion GCP -->
       <Instruccion02>
       call TC_ABONA_TARJETA_REGALO (?,?,?,?,?,?,?,?,?,?,?,?)
       </Instruccion02>
		
		<!-- PL anulacion GCP -->
       <Instruccion03>
       call tc_anula_abono_tarjeta_regalo(?,?,?,?,?,?,?,?,?,?,?)
       </Instruccion03>

		<!-- Query que obtiene secuencia para activar GCP -->
       <Instruccion04>
       SELECT 
       		OPS$CREDI_ADM.seq_nro_trx_gcp.nextval as nro_transaccion
       FROM 
       		dual
       </Instruccion04>
      
      </NombreBean>
      
      <NombreBean valor="gestion_45">
	<!--  Obtengo datos originales para anulacion (n boleta, fecha, monto)  -->
      <Instruccion01>
      	SELECT 
				fecha,
				nro_tarjeta_car,
				monto,
				monto_refina,
				nro_documento,
				nro_cuotas
		FROM 
				CREDI_TR_ACT_DES_TV
		WHERE 
				nro_tarjeta_car = ?
		AND	  
				nro_tarjeta_gcp = ?
		AND 	
				sucursal = ?
		AND
				caja = ?			
      </Instruccion01>
	
<!-- Guardo registro de activacion en tabla de auditoria -->
      <Instruccion02>
      	INSERT INTO 
      	credi_tr_act_des_tv (FECHA,
      						NRO_TARJETA_GCP,
      						NRO_TARJETA_CAR,
      						SUCURSAL,
							CAJA,
							NRO_DOCUMENTO,
							COD_TRANSACCION,
							NRO_TRANSACCION,
							MONTO,
							NRO_CUOTAS,
							STATUS,
							USUARIO,
							MONTO_REFINA,
							VOUCHER,
							RUT_CLIENTE,
							RUT_VENDEDOR,
							DOCTO_ORIGINAL,
							DIFERIDO)
							
		VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
      </Instruccion02>
		
	<!-- INVOCO PL DE REVERSA GCP -->
      <Instruccion03>      
	      call tc_reversa_abono_tarjeta_rega (?,?,?)
      </Instruccion03>
		
      <!-- Query que obtiene nro documento para activar GCP en servicio mirror SPRB-->
       <Instruccion04>
       SELECT 
       		OPS$CREDI_ADM.seq_nro_dctotrx_gcp.nextval as nro_documento
       FROM 
       		dual
       </Instruccion04>   
       
      </NombreBean>

	<!-- instrucciones para activacon GCP en BackOffice -->      
      <NombreBean valor="gestion_46">
		<!--  insert tabla trx_abonos-->
      <Instruccion01>
      	INSERT INTO 
      		TRX_ABONOS (FECHA_TRX,
						SUCURSAL,
						NRO_CAJA,
						NRO_TRANSACCION,
						NRO_DOCUMENTO,
						TIPO_TRX,
						ADMINISTRADORA,
						EMISOR,
						TARJETA,
						RUT_TITULAR,
						RUT_PODER,
						EMPRESA_RECAUDADA,
						CONVENIO_RECAUDADO,
						MONTO,
						MONTO_RECAUDACION,
						INTERES_MORA,
						GASTOS_MORA,
						DESCUENTOS_GASTOS,
						DESCUENTOS_INTERESES,
						CODIGO_AUTORIZADOR,
						PLAZO,
						DIFERIDO,
						COMISION,
						CUOTA,
						TOTAL_TRANSACCION,
						CODIGO_RECAUDACION,
						CODIGO_CREDITO,
						TRX_FACTURA,
						NRO_PAN)
      	VALUES	(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
      </Instruccion01>
	
	<!--  -->
      <Instruccion02>
      INSERT INTO TRX_TRANSACCION (
				FECHA_TRX,	
				SUCURSAL,
				NRO_CAJA,
				NRO_TRANSACCION,
				NRO_DOCUMENTO,
				TIPO_TRX,
				MONTO_TRX,
				SUC_ORIGINAL,
				FECHA_ORIGINAL,
				NRO_CAJA_ORIGINAL,
				NRO_DOCTO_ORIGINAL,
				VENDEDOR_ORIGINAL,
				SUPERVISOR,
				VENDEDOR,
				ORIGEN_TRX,
				RUT_COMPRA_PAGA,
				DESCUENTO_ECCSA,
				DESCUENTO_CAR,
				MONTO_PIE,
				FECHA_HORA_TRX,
				ESTADO,
				TIPO_ORIGEN,
				TXTRN_RUN_CAJ_CRO,
				TXTRN_RUN_CAJ_CRO_ORI,
				TXTRN_MNT_DNN )
		VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
      </Instruccion02>
		
	<!-- inserta datos en tabla 'trx_tar_ripley' de BackOffice -->
      <Instruccion03>
      
      	INSERT INTO trx_tar_ripley ( FECHA_TRX,
									SUCURSAL,
									NRO_CAJA,
									NRO_TRANSACCION,
									ADMINIS,
									EMISOR,
									TARJETA,
									RUT_TITULAR,
									RUT_PODER,
									PLAZO,
									DIFERIDO,
									MONTO_CAPITAL,
									MONTO_PIE,
									DESCTO_CAR,
									CODIGO_DESCTO,
									COD_AUTORIZADOR,
									PORC_PARTICIP,
									NRO_PAN)
                                        
		VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
		
      </Instruccion03>
		
      <Instruccion04>      
      </Instruccion04>      
       
      </NombreBean>
      
      
      <!--  AGA 20071109 - AUDITORIA ACTIVACION GCP-->
	<NombreBean valor="gestion_47">
	<!-- Despliegue de datos, busqueda por fecha-->
       <Instruccion01>
       SELECT  fecha, nro_tarjeta_gcp, nro_tarjeta_car, rut_cliente, rut_vendedor, sucursal, caja, nro_documento,
				docto_original, nro_transaccion, cod_transaccion, monto, nro_cuotas, diferido, monto_refina,
       			status, usuario, voucher      			
		FROM  (  SELECT
                        ROW_NUMBER() OVER (order by fecha desc) AS C1,
						fecha, 
						to_char(nro_tarjeta_gcp) as nro_tarjeta_gcp, 
						to_char(nro_tarjeta_car) as nro_tarjeta_car,
						decode(rut_cliente,null,'0',rut_cliente) AS rut_cliente,
						decode(rut_vendedor,null,'0',rut_vendedor) AS rut_vendedor,  
						sucursal, 
						caja, 
						nro_documento,
						decode(docto_original,null,'0',docto_original) AS docto_original,  
						nro_transaccion,
						cod_transaccion, 
       					monto, 
       					nro_cuotas,
       					decode(diferido,null,'0',diferido) AS diferido, 
						monto_refina,
       					status, 
       					usuario,
       					voucher      	
                FROM
                        credi_tr_act_des_tv
                WHERE
                        trunc(fecha) = to_date(?,'yyyy-mm-dd')
                AND
				   		cod_transaccion in (28,38,42,44)
				   		
                ORDER BY nro_transaccion ASC

        ) TABLA

    	 WHERE TABLA.C1 &#0062; ?

        AND TABLA.C1 &#0060; ?    
       </Instruccion01>
	<!-- paginacion de reporte-->
       <Instruccion02>
       
       SELECT count(1) 
       	FROM (
                    SELECT
                        ROW_NUMBER() OVER (order by fecha desc) AS C1,
						fecha, 
						decode(rut_cliente,null,'0',rut_cliente) AS rut_cliente,
						decode(rut_vendedor,null,'0',rut_vendedor) AS rut_vendedor,  
						sucursal, 
						caja, 
						nro_documento,
						decode(docto_original,null,'0',docto_original) AS docto_original,
						nro_transaccion,
						cod_transaccion, 
       					monto, 
       					nro_cuotas, 
       					decode(diferido,null,'0',diferido) AS diferido,
						monto_refina,
       					status, 
       					usuario,
       					voucher       					

                FROM
                        credi_tr_act_des_tv
                WHERE
                        trunc(fecha) = to_date(?,'yyyy-mm-dd')
                AND
				   		cod_transaccion in (28,38,42,44)
				   		        
                ORDER BY nro_transaccion ASC
                        
        )TABLA
             
       </Instruccion02>
		
	<!-- query exportacion -->	
       <Instruccion03>
       			SELECT
                		fecha, 
						to_char(nro_tarjeta_gcp) as nro_tarjeta_gcp, 
						to_char(nro_tarjeta_car) as nro_tarjeta_gcp, 
						decode(rut_cliente,null,'0',rut_cliente) AS rut_cliente,
						decode(rut_vendedor,null,'0',rut_vendedor) AS rut_vendedor,  
						sucursal, 
						caja, 
						nro_documento,
						decode(docto_original,null,'0',docto_original) AS docto_original,
						nro_transaccion,
						cod_transaccion, 
       					monto, 
       					nro_cuotas, 
       					decode(diferido,null,'0',diferido) AS diferido,
						monto_refina,
       					status, 
       					usuario,
       					voucher       
                FROM
                        credi_tr_act_des_tv
                WHERE
                        trunc(fecha) = to_date(?,'yyyy-mm-dd')
                AND
				   		cod_transaccion in (28,38,42,44)
				   		        
                ORDER BY nro_transaccion ASC
                        
       </Instruccion03>

       <Instruccion04>
       </Instruccion04>
      
      </NombreBean>
      
      
    <!--  AGA 20071115 - apertura-cierra ACTIVACION GCP-->
	<NombreBean valor="gestion_48">
	<!-- Valido si existe trx de apertura o cierre segun parametro 'tipo_trx' -->
       <Instruccion01>
		SELECT
			nvl(sucursal,0)
		FROM
			trx_administrativa2
		WHERE 
			sucursal =?
		AND	
			nro_caja = ?
		AND
			tipo_trx = ? 
		AND
			fecha_trx = ?
       </Instruccion01>
	<!-- Invoco pl que ejecuta insert de apertura en 'trx_transaccion'-->
       <Instruccion02>
       call APERTURA_GCP_WEB (?,?,?,?,?,?,?,?,?,?,?)
       </Instruccion02>
	<!-- Invoco pl que ejecuta insert de cierre en 'trx_transaccion'-->
       <Instruccion03>
       call CIERRE_GCP_WEB (?,?,?,?,?,?,?,?,?,?,?,?,?)		
       </Instruccion03>

	<!-- Obtengo fecha ultima activacin. Para apertura-cierre Automatico desde BO-->
       <Instruccion04>
		SELECT 
			fecha_trx, max(nro_transaccion)
		FROM 
			trx_administrativa2
		WHERE 
			sucursal = ?
		AND 
			nro_caja = ?
		AND
			tipo_trx = ?			
		GROUP BY
			fecha_trx
		ORDER BY
			fecha_trx desc

       </Instruccion04>
      
      </NombreBean>    
      
      
      <!-- Actualizacion FECHA BOLETAS -->
      <NombreBean valor="gestion_50">
	<!--  Obtengo boletas con X fecha -->
      <Instruccion01>
      	SELECT  correlativo_venta, numero_sucursal, fecha_creacion, monto_venta, estado
		FROM  (  SELECT
                        ROW_NUMBER() OVER (order by correlativo_venta) AS C1,
                        correlativo_venta,
                        numero_sucursal,
                        fecha_creacion,
                        monto_venta,
                        estado
                FROM
                        nota_venta
                WHERE
                        DATE(fecha_creacion) = ?

                AND
                        estado = 1
				ORDER BY fecha_creacion desc
        ) TABLA

    	 WHERE TABLA.C1 &#0062; ?

        AND TABLA.C1 &#0060; ?    
      </Instruccion01>
      
      
	<!-- Actualizo fecha de boletas en estado 'pendiente de impresion' -->
	
      <Instruccion02>
	     UPDATE NOTA_VENTA SET FECHA_CREACION = 
			
      </Instruccion02>
      
      
	<!-- Despliegue de registros actualizados -->
      <Instruccion03>
      
      SELECT  correlativo_venta, numero_sucursal, fecha_creacion, monto_venta, estado
		FROM  (  SELECT
                        ROW_NUMBER() OVER (order by correlativo_venta) AS C1,
                 		correlativo_venta,
                 		numero_sucursal,
                		fecha_creacion,
		                monto_venta,		                
		                estado
		 		  FROM 
		 		  		nota_venta
		          WHERE 
		          		char(fecha_creacion) like (?)
		          AND
		          		estado in (1)
				  ORDER BY fecha_creacion desc
        ) TABLA

    	 WHERE TABLA.C1 &#0062; ?

        AND TABLA.C1 &#0060; ?    
    
		
      </Instruccion03>
		
	<!-- Paginacion consulta boletas -->
      <Instruccion04>
      
      select count(1) from (

                    SELECT
                        correlativo_venta,
                        numero_sucursal
                        fecha_creacion,
                        monto_venta,
                        estado
	                FROM
	                        nota_venta
	                WHERE
	                        DATE(fecha_creacion) = ?	
	                AND
	                        estado = 1
	                ORDER BY 
	                		fecha_creacion desc
	                
             )tabla            
          
      </Instruccion04>      
       
      </NombreBean>
    
    <!-- Actualiza FECHA BOLETA -->
    <NombreBean valor="gestion_51">
	<!--  Exportar a excel boleta original-->
      <Instruccion01>
				SELECT
                        correlativo_venta,
                        numero_sucursal,
                        fecha_creacion,
                        monto_venta,
                        estado
                FROM
                        nota_venta
                WHERE
                        DATE(fecha_creacion) = ?

                AND
                        estado = 1
                        
               ORDER BY fecha_creacion desc
      </Instruccion01>
	
	<!-- Exportar a excel boletas ACTUALIZADAS -->
      <Instruccion02>
      SELECT
				correlativo_venta,
				numero_sucursal,
                fecha_creacion,
                monto_venta,
                estado
 		  FROM 
 		  		nota_venta
          WHERE 
          		char(fecha_creacion) like (?)
          AND
          		estado in (1,2,3,4)
          		
          ORDER BY fecha_creacion desc
      </Instruccion02>
		
      <Instruccion03>
      
      select count(1) from (
	      SELECT
					correlativo_venta,
					numero_sucursal,
	                fecha_creacion,
	                monto_venta,
	                estado
	 		  FROM 
	 		  		nota_venta
	          WHERE 
	          		char(fecha_creacion) like (?)
	          AND
	          		estado in (1,2,3,4)
	    ) tabla
      </Instruccion03>
		
	<!-- Obtengo registros para guardar 'en memoria' cuando realice e
	    el Update -->	
      <Instruccion04>      
				SELECT
                        correlativo_venta,
                        numero_sucursal,
                        fecha_creacion,
                        monto_venta,
                        estado
                FROM
                        nota_venta
                WHERE
                        DATE(fecha_creacion) = ?

                AND
                        estado = 1
				ORDER BY fecha_creacion desc
      </Instruccion04>      
       
      </NombreBean>
      
    
    <!-- AGA 20071113 Busqueda RMC-->
    <NombreBean valor="gestion_52">
      <Instruccion01>
      
      SELECT  fecha_rmc, nro_rmc,usuario,cod_articulo,unidades, descuento,valor_unit, monto_rmc,nro_caja,
		      nro_transaccion,fecha_trx,sucursal,estado 
      	FROM  (  SELECT
					ROW_NUMBER() OVER (order by a.nro_rmc) AS C1,
					to_char(a.fecha_rmc,'dd/mm/yyyy HH24:mi:ss') as fecha_rmc,
					a.nro_rmc as nro_rmc,
					a.usuario as usuario,
					b.cod_articulo as cod_articulo, 
					b.unidades as unidades,
					b.descuento as descuento, 
					valor_unit as valor_unit, 
					a.monto_rmc as monto_rmc,
					a.nro_caja as nro_caja,
					a.nro_transaccion as nro_transaccion,
					to_char(a.fecha_trx,'dd/mm/yyyy')as fecha_trx, 
					a.sucursal as sucursal,
					decode(a.estado,1,'Generada',2,'Anulada',3,'Procesada en Caja') as estado 			   				
				FROM
					rmc_encabezado a, 
				 	rmc_detalle b 
				WHERE
					a.nro_rmc = b.nro_rmc 
				AND
					a.nro_rmc = ?
				ORDER BY
					a.nro_rmc
		
        ) TABLA

    	 WHERE TABLA.C1 &#0062; ?

        AND TABLA.C1 &#0060; ?            
		
      </Instruccion01>
	  <Instruccion02>
	  select count(1) from (
	     	SELECT
					to_char(a.fecha_rmc,'dd/mm/yyyy HH24:mi:ss') as fecha_rmc,
					a.nro_rmc as nro_rmc,
					a.usuario as usuario,
					b.cod_articulo as cod_articulo, 
					b.unidades as unidades,
					b.descuento as descuento, 
					valor_unit as valor_unit, 
					a.monto_rmc as monto_rmc,
					a.nro_caja as nro_caja,
					a.nro_transaccion as nro_transaccion,
					to_char(a.fecha_trx,'dd/mm/yyyy')as fecha_trx, 
					a.sucursal as sucursal,
					decode(a.estado,1,'Generada',2,'Anulada',3,'Procesada en Caja') as estado
			   				
				FROM
					rmc_encabezado a, 
				 	rmc_detalle b 
				WHERE
					a.nro_rmc = b.nro_rmc 
				AND
					a.nro_rmc = ?
				ORDER BY
					a.nro_rmc
	    ) tabla
      
      </Instruccion02>
		
      <!-- exportar reporte -->
      <Instruccion03>
      			SELECT
					to_char(a.fecha_rmc,'dd/mm/yyyy HH24:mi:ss') as fecha_rmc,
					a.nro_rmc as nro_rmc,
					a.usuario as usuario,
					b.cod_articulo as cod_articulo, 
					b.unidades as unidades,
					b.descuento as descuento, 
					valor_unit as valor_unit, 
					a.monto_rmc as monto_rmc,
					a.nro_caja as nro_caja,
					a.nro_transaccion as nro_transaccion,
					to_char(a.fecha_trx,'dd/mm/yyyy')as fecha_trx, 
					a.sucursal as sucursal,
					decode(a.estado,1,'Generada',2,'Anulada',3,'Procesada en Caja') as estado
			   				
				FROM
					rmc_encabezado a, 
				 	rmc_detalle b 
				WHERE
					a.nro_rmc = b.nro_rmc 
				AND
					a.nro_rmc = ?
				ORDER BY
					a.nro_rmc
	    
      </Instruccion03>
		
      <Instruccion04>      
      </Instruccion04>      
       
      </NombreBean>
      
    <!-- AGA 20071113 Reporte RMC-->
    <NombreBean valor="gestion_53">
	<!--  RMC USUARIOS -->
      <Instruccion01>
      
      SELECT  RUT, NOMBRES, AP_PATERNO, AP_MATERNO, USUARIO, CLAVE, ID_PERFIL
      	FROM  (  SELECT
					ROW_NUMBER() OVER (order by rut) AS C1,
					RTRIM (TO_CHAR (RUT)) || '-' || TO_CHAR (DV) AS rut,
					NOMBRES,
					AP_PATERNO, 
					AP_MATERNO, 
					USUARIO,
					CLAVE,
					ID_PERFIL					
				FROM
					rmc_usuario 
				ORDER BY 3
        ) TABLA

    	 WHERE TABLA.C1 &#0062; ?

        AND TABLA.C1 &#0060; ?            
		
      </Instruccion01>
	  <Instruccion02>
	  select count(1) from (
	     	SELECT
				rut,
				NOMBRES,
				AP_PATERNO, 
				AP_MATERNO, 
				USUARIO,
				CLAVE,
				ID_PERFIL					
			FROM
				rmc_usuario 
			ORDER BY 3
	    ) tabla
      
      </Instruccion02>
		
      <!-- exportar reporte -->
      <Instruccion03>
      		SELECT
				RTRIM (TO_CHAR (RUT)) || '-' || TO_CHAR (DV) AS rut,
				NOMBRES,
				AP_PATERNO, 
				AP_MATERNO, 
				USUARIO,
				CLAVE,
				ID_PERFIL					
			FROM
				rmc_usuario 
			ORDER BY 3
	    
      </Instruccion03>
		
      <Instruccion04>      
      </Instruccion04>      
       
      </NombreBean>
      
      
    <!-- AGA 20071119 APERTURA CIERRE ACTIVACION GCP-->
    <NombreBean valor="gestion_54">
	<!-- Invoco pl que ejecuta insert de apertura en 'trx_transaccion'-->
       <Instruccion01>
       call APERTURA_GCP_WEB (?,?,?,?,?,?,?,?,?,?,?)
       </Instruccion01>
	<!-- Invoco pl que ejecuta insert de cierre en 'trx_transaccion'-->
       <Instruccion02>
       call CIERRE_GCP_WEB (?,?,?,?,?,?,?,?,?,?,?,?,?)		
       </Instruccion02>
       
       <!--  AGA 20071120 
       Invoco Query que obtiene total_activacion, total_anulacion
    	para opcion 'Cierre TOTAL' -->
      <Instruccion03>	    
		SELECT
			nvl(sum(tot_activ),0) as total_activacion,
			nvl(sum(tot_desac),0) as total_desactivacion
		FROM (
				SELECT 
					sum(monto) as tot_activ, 0 tot_desac		
				FROM
					 trx_abonos
				WHERE  
					fecha_trx = to_date (?,'dd-mm-yyyy')
				AND 
					sucursal = ?
				AND
					 nro_caja = ?
				AND
					 tipo_trx = ? 	-- 28 activacion
				UNION
				
				SELECT 
					0 tot_activ, sum(monto) as tot_desac  
				FROM
					trx_abonos
				WHERE
				  	fecha_trx = to_date (?,'dd-mm-yyyy')
				AND
					sucursal = ?
				AND
					nro_caja = ?
				AND 
					tipo_trx = ?   -- 38 desactivacion
		)TABLA
      
      </Instruccion03>
      		
      <Instruccion04>            
      </Instruccion04>      
       
      </NombreBean>      
      
      
      
      
      
      
      <!-- AGA 20080227 MECANISMO VERIFICADOR VENTAS TELEFONICAS-->
    <NombreBean valor="gestion_56">

       <!-- Busqueda ventas por 'NICK' de usuario -->
       <Instruccion01>
		SELECT  TELECANAL, OC, SUCURSAL, FECHA_CREACION, ESTADO, MONTO, RUT, cliente, TELEFONO, COD_REGALO, BOLETA, NOTA_CREDITO, FORMA_PAGO
      		FROM  (  
      			SELECT
					ROW_NUMBER() OVER (order by nv.CORRELATIVO_VENTA) AS C1,
					RTRIM (VALUE (CHAR ( nv.DV_BOLETA), '')) AS TELECANAL,
			        nv.CORRELATIVO_VENTA AS OC,
			        suc.TVMAS_GLS_DES AS SUCURSAL,
			        nv.fecha_hora_creacion AS FECHA_CREACION,
			        NV.ESTADO AS ESTADO,
			        NV.MONTO_VENTA AS MONTO,
			        RTRIM (CHAR(nv.RUT_COMPRADOR)) || '-' || RTRIM(CHAR(nv.DV_COMPRADOR))   AS RUT,
			        RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente,
			        RTRIM (VALUE (CHAR (d.telefono_despacho), '-')) AS TELEFONO,
			        RTRIM (VALUE (CHAR (NV.CODIGO_REGALO), '-')) AS COD_REGALO,
			        RTRIM (VALUE (CHAR (NV.NUMERO_BOLETA), '-')) AS BOLETA,
			        RTRIM (VALUE (CHAR ( NV.NUM_NOTA_CREDITO), '-')) AS NOTA_CREDITO,
			        VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TBANCARIA') as FORMA_PAGO
		        
				FROM   	despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
				
				WHERE  	nv.CORRELATIVO_VENTA = D.CORRELATIVO_VENTA
				
				AND    	nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				
				AND   	u.logonid = ?
										
		) TABLA

    	 WHERE TABLA.C1 &#0062; ?

        AND TABLA.C1 &#0060; ?   
        
        ORDER BY FECHA_CREACION desc
        
       </Instruccion01>

		<!-- Paginacion Busqueda ventas por 'NICK' de usuario -->
       <Instruccion02>
		
		select count(1) from (
	     	SELECT
					RTRIM (VALUE (CHAR ( nv.DV_BOLETA), '')),
					nv.CORRELATIVO_VENTA AS OC,					
			        suc.TVMAS_GLS_DES AS SUCURSAL,
					nv.fecha_hora_creacion AS FECHA_CREACION,
			        NV.ESTADO AS ESTADO,
			        NV.MONTO_VENTA AS MONTO,
			        RTRIM (CHAR(nv.RUT_COMPRADOR)) || '-' || RTRIM(CHAR(nv.DV_COMPRADOR))   AS RUT,
			        RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente,
			        RTRIM (VALUE (CHAR (d.telefono_despacho), '-')) AS TELEFONO,
			        RTRIM (VALUE (CHAR (NV.CODIGO_REGALO), '-')) AS COD_REGALO,
			        RTRIM (VALUE (CHAR (NV.NUMERO_BOLETA), '-')) AS BOLETA,
			        RTRIM (VALUE (CHAR ( NV.NUM_NOTA_CREDITO), '-')) AS NOTA_CREDITO,
			        VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TBANCARIA') as FORMA_PAGO
		        
				FROM   	despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
				
				WHERE  	nv.CORRELATIVO_VENTA = D.CORRELATIVO_VENTA
				
				AND    	nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				
				AND   	u.logonid = ?
										
				ORDER BY FECHA_CREACION desc
	    ) tabla
	    
	    
	    
       </Instruccion02>

		<!-- Query llena combo con 'nick' de usuarios -->
       <Instruccion03>
         SELECT 
				logonid from userreg
		WHERE
				LOGONID like ('FCH_%')
       </Instruccion03>
      		
      <!-- Actualiza registros con marca 'T' (TeleCanal) en el campo 'dv_boleta -->
      <Instruccion04>            
      	UPDATE 
      		nota_venta
      	SET 
      		dv_boleta = 'T'
      	WHERE 
      		correlativo_venta in (X)
      		
      </Instruccion04>      
       
      </NombreBean>      
      
      
	<!-- AGA 20080227 MECANISMO VERIFICADOR VENTAS TELEFONICAS-->
    <NombreBean valor="gestion_57">

       <!-- Busqueda ventas por FECHA -->
       <Instruccion01>
		SELECT  TELECANAL, OC, SUCURSAL, FECHA_CREACION, ESTADO, MONTO, RUT, cliente, TELEFONO, COD_REGALO, BOLETA, NOTA_CREDITO, FORMA_PAGO
      		FROM  (  
      			SELECT
					ROW_NUMBER() OVER (order by nv.CORRELATIVO_VENTA) AS C1,
					RTRIM (VALUE (CHAR ( nv.DV_BOLETA), '')) AS TELECANAL,
			        nv.CORRELATIVO_VENTA AS OC,
			        suc.TVMAS_GLS_DES AS SUCURSAL,
			        nv.fecha_hora_creacion AS FECHA_CREACION,
			        NV.ESTADO AS ESTADO,
			        NV.MONTO_VENTA AS MONTO,
			        RTRIM (CHAR(nv.RUT_COMPRADOR)) || '-' || RTRIM(CHAR(nv.DV_COMPRADOR))   AS RUT,
			        RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente,
			        RTRIM (VALUE (CHAR (d.telefono_despacho), '-')) AS TELEFONO,
			        RTRIM (VALUE (CHAR (NV.CODIGO_REGALO), '-')) AS COD_REGALO,
			        RTRIM (VALUE (CHAR (NV.NUMERO_BOLETA), '-')) AS BOLETA,
			        RTRIM (VALUE (CHAR ( NV.NUM_NOTA_CREDITO), '-')) AS NOTA_CREDITO,
			        VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TARJ. BANCARIA') as FORMA_PAGO
		        
				FROM   	despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
				
				WHERE  	nv.CORRELATIVO_VENTA = D.CORRELATIVO_VENTA
				
				AND    	nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				
				AND   	DATE (nv.fecha_hora_creacion) =  ?				
		
		) TABLA

    	 WHERE TABLA.C1 &#0062; ?

        AND TABLA.C1 &#0060; ?   
        
        ORDER BY FECHA_CREACION desc
       </Instruccion01>

		<!-- Paginacion busque por fecha -->
       <Instruccion02>
       
       select count(1) from (
	     	SELECT
					RTRIM (VALUE (CHAR ( nv.DV_BOLETA), '')),
					nv.CORRELATIVO_VENTA AS OC,
			        suc.TVMAS_GLS_DES AS SUCURSAL,
			        nv.fecha_hora_creacion AS FECHA_CREACION,
			        NV.ESTADO AS ESTADO,
			        NV.MONTO_VENTA AS MONTO,
			        RTRIM (CHAR(nv.RUT_COMPRADOR)) || '-' || RTRIM(CHAR(nv.DV_COMPRADOR))   AS RUT,
			        RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente,
			        RTRIM (VALUE (CHAR (d.telefono_despacho), '-')) AS TELEFONO,
			        RTRIM (VALUE (CHAR (NV.CODIGO_REGALO), '-')) AS COD_REGALO,
			        RTRIM (VALUE (CHAR (NV.NUMERO_BOLETA), '-')) AS BOLETA,
			        RTRIM (VALUE (CHAR ( NV.NUM_NOTA_CREDITO), '-')) AS NOTA_CREDITO,
			        VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TBANCARIA') as FORMA_PAGO
		        
				FROM   	despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
				
				WHERE  	nv.CORRELATIVO_VENTA = D.CORRELATIVO_VENTA
				
				AND    	nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				
				AND   	DATE (nv.fecha_hora_creacion) =  ?	
				
				ORDER BY FECHA_CREACION desc
	    ) tabla
	    
	    
		
       </Instruccion02>


		<!-- Busqueda por 'NICK' y fecha -->
       <Instruccion03>

		SELECT  TELECANAL, OC, SUCURSAL, FECHA_CREACION, ESTADO, MONTO, RUT, cliente, TELEFONO, COD_REGALO, BOLETA, NOTA_CREDITO, FORMA_PAGO
      		FROM  (  
      			SELECT
					ROW_NUMBER() OVER (order by nv.CORRELATIVO_VENTA) AS C1,
					RTRIM (VALUE (CHAR ( nv.DV_BOLETA), '')) AS TELECANAL,
			        nv.CORRELATIVO_VENTA AS OC,
			        suc.TVMAS_GLS_DES AS SUCURSAL,
			        nv.fecha_hora_creacion AS FECHA_CREACION,
			        NV.ESTADO AS ESTADO,
			        NV.MONTO_VENTA AS MONTO,
			        RTRIM (CHAR(nv.RUT_COMPRADOR)) || '-' || RTRIM(CHAR(nv.DV_COMPRADOR))   AS RUT,
			        RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente,
			        RTRIM (VALUE (CHAR (d.telefono_despacho), '-')) AS TELEFONO,
			        RTRIM (VALUE (CHAR (NV.CODIGO_REGALO), '-')) AS COD_REGALO,
			        RTRIM (VALUE (CHAR (NV.NUMERO_BOLETA), '-')) AS BOLETA,
			        RTRIM (VALUE (CHAR ( NV.NUM_NOTA_CREDITO), '-')) AS NOTA_CREDITO,
			        VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TARJ. BANCARIA') as FORMA_PAGO
		        
				FROM   	despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
				
				WHERE  	nv.CORRELATIVO_VENTA = D.CORRELATIVO_VENTA
				
				AND    	nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				
				AND   	DATE (nv.fecha_hora_creacion) =  ?				
				
				AND   	u.logonid = ?			
		
		) TABLA

    	 WHERE TABLA.C1 &#0062; ?

        AND TABLA.C1 &#0060; ?   
        
        ORDER BY FECHA_CREACION desc
        
       </Instruccion03>
      		
      <!-- contador registros busqueda por 'NICK' y Fecha -->
      <Instruccion04>            
      select count(1) from (
	     	SELECT
					RTRIM (VALUE (CHAR ( nv.DV_BOLETA), '')),
					nv.CORRELATIVO_VENTA AS OC,
			        suc.TVMAS_GLS_DES AS SUCURSAL,
			        nv.fecha_hora_creacion AS FECHA_CREACION,
			        NV.ESTADO AS ESTADO,
			        NV.MONTO_VENTA AS MONTO,
			        RTRIM (CHAR(nv.RUT_COMPRADOR)) || '-' || RTRIM(CHAR(nv.DV_COMPRADOR))   AS RUT,
			        RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente,
			        RTRIM (VALUE (CHAR (d.telefono_despacho), '-')) AS TELEFONO,
			        RTRIM (VALUE (CHAR (NV.CODIGO_REGALO), '-')) AS COD_REGALO,
			        RTRIM (VALUE (CHAR (NV.NUMERO_BOLETA), '-')) AS BOLETA,
			        RTRIM (VALUE (CHAR ( NV.NUM_NOTA_CREDITO), '-')) AS NOTA_CREDITO,
			        VALUE(CHAR(t.correlativo_venta-t.correlativo_venta),'TBANCARIA') as FORMA_PAGO
		        
				FROM   	despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
				
				WHERE  	nv.CORRELATIVO_VENTA = D.CORRELATIVO_VENTA
				
				AND    	nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				
				AND   	DATE (nv.fecha_hora_creacion) =  ?
				
				AND   	u.logonid = ?				
				
				ORDER BY FECHA_CREACION desc
	    ) tabla
      </Instruccion04>      
       
      </NombreBean>
      
      
      
    <!-- AGA 20080306 Exportar Reportes TeleCanal-->
    <NombreBean valor="gestion_58">

       <!-- Exportacion Busqueda por FECHA -->
       <Instruccion01>
 
      			SELECT
					
					CASE when value(nv.dv_boleta, ' ') = 'T' THEN 'X' ELSE '' END AS VENTA,
			        nv.CORRELATIVO_VENTA AS OC,
			        suc.TVMAS_GLS_DES AS SUCURSAL,
			        nv.fecha_hora_creacion AS FECHA_CREACION,
			        NV.ESTADO AS ESTADO,
			        NV.MONTO_VENTA AS MONTO,
			        RTRIM (CHAR(nv.RUT_COMPRADOR)) || '-' || RTRIM(CHAR(nv.DV_COMPRADOR))   AS RUT,
			        RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente,
			        RTRIM (VALUE (CHAR (d.telefono_despacho), '-')) AS TELEFONO,
			        RTRIM (VALUE (CHAR (NV.CODIGO_REGALO), '-')) AS COD_REGALO,
			        RTRIM (VALUE (CHAR (NV.NUMERO_BOLETA), '-')) AS BOLETA,
			        RTRIM (VALUE (CHAR ( NV.NUM_NOTA_CREDITO), '-')) AS NOTA_CREDITO,
			        CASE when (t.correlativo_venta-t.correlativo_venta) = 0 THEN 'TARJ.RIPLEY' ELSE 'TARJ.BANCARIA' END AS FORMA_PAGO
		        
				FROM   	despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
				
				WHERE  	nv.CORRELATIVO_VENTA = D.CORRELATIVO_VENTA
				
				AND    	nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				
				AND   	DATE (nv.fecha_hora_creacion) =  ?				
				
				ORDER BY FECHA_CREACION desc
		
       </Instruccion01>

		<!-- Exportacion Busqueda por NICK usuario -->
       <Instruccion02>
       
       		SELECT
					CASE when value(nv.dv_boleta, ' ') = 'T' THEN 'X' ELSE '' END AS VENTA,
					nv.CORRELATIVO_VENTA AS OC,
			        suc.TVMAS_GLS_DES AS SUCURSAL,
			        nv.fecha_hora_creacion AS FECHA_CREACION,
			        NV.ESTADO AS ESTADO,
			        NV.MONTO_VENTA AS MONTO,
			        RTRIM (CHAR(nv.RUT_COMPRADOR)) || '-' || RTRIM(CHAR(nv.DV_COMPRADOR))   AS RUT,
			        RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente,
			        RTRIM (VALUE (CHAR (d.telefono_despacho), '-')) AS TELEFONO,
			        RTRIM (VALUE (CHAR (NV.CODIGO_REGALO), '-')) AS COD_REGALO,
			        RTRIM (VALUE (CHAR (NV.NUMERO_BOLETA), '-')) AS BOLETA,
			        RTRIM (VALUE (CHAR ( NV.NUM_NOTA_CREDITO), '-')) AS NOTA_CREDITO,
			        CASE when (t.correlativo_venta-t.correlativo_venta) = 0 THEN 'TARJ.RIPLEY' ELSE 'TARJ.BANCARIA' END AS FORMA_PAGO
		        
				FROM   	despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
				
				WHERE  	nv.CORRELATIVO_VENTA = D.CORRELATIVO_VENTA
				
				AND    	nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				
				AND   	DATE (nv.fecha_hora_creacion) =  ?
				
				AND   	u.logonid = ?		
	    	
	    		ORDER BY FECHA_CREACION desc
	    
		
       </Instruccion02>


		<!-- Exportacion Busqueda por 'NICK' y fecha -->
       <Instruccion03>
 
      			SELECT
					
					CASE when value(nv.dv_boleta, ' ') = 'T' THEN 'X' ELSE '' END AS VENTA,
			        nv.CORRELATIVO_VENTA AS OC,
			        suc.TVMAS_GLS_DES AS SUCURSAL,
			        nv.fecha_hora_creacion AS FECHA_CREACION,
			        NV.ESTADO AS ESTADO,
			        NV.MONTO_VENTA AS MONTO,
			        RTRIM (CHAR(nv.RUT_COMPRADOR)) || '-' || RTRIM(CHAR(nv.DV_COMPRADOR))   AS RUT,
			        RTRIM(substr(d.NOMBRE_CLIENTE || ' ' || d.APELLIDO_PAT_CLIENTE || ' ' || d.APELLIDO_MAT_CLIENTE,1,50)) AS cliente,
			        RTRIM (VALUE (CHAR (d.telefono_despacho), '-')) AS TELEFONO,
			        RTRIM (VALUE (CHAR (NV.CODIGO_REGALO), '-')) AS COD_REGALO,
			        RTRIM (VALUE (CHAR (NV.NUMERO_BOLETA), '-')) AS BOLETA,
			        RTRIM (VALUE (CHAR ( NV.NUM_NOTA_CREDITO), '-')) AS NOTA_CREDITO,
			        CASE when (t.correlativo_venta-t.correlativo_venta) = 0 THEN 'TARJ.RIPLEY' ELSE 'TARJ.BANCARIA' END AS FORMA_PAGO
		        
				FROM   	despacho d,(((nota_venta nv left join tarjeta_ripley t on  nv.correlativo_venta = t.correlativo_venta) left join tarjeta_ripley tb on nv.correlativo_venta = tb.correlativo_venta) left join ordmeextn ox on nv.correlativo_venta=ox.orders_id)  left join userreg u on BIGINT(ox.field1) = u.users_id ,FETVIR_MAE_SUC suc
				
				WHERE  	nv.CORRELATIVO_VENTA = D.CORRELATIVO_VENTA
				
				AND    	nv.NUMERO_SUCURSAL = suc.TVMAS_COD_SUC
				
				AND   	DATE (nv.fecha_hora_creacion) =  ?				
				
				AND   	u.logonid = ?			
		
		        ORDER BY FECHA_CREACION desc
        
       </Instruccion03>
      		
     
      <Instruccion04>                 
      </Instruccion04>      
       
      </NombreBean>
      
      
      
      <!-- AGA 20080428 REPORTES REFINANCIACION -->
    <NombreBean valor="gestion_60">
    <!-- total Registros busqueda por Fecha -->
	 <Instruccion01>

        SELECT 
             count(1) from (

                    SELECT 

                    	FETVIR_MAE_REF_SOL.TVMRS_GLS_RUN as rut,

                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_FON), '-')) as fono,

                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_CEL), '-')) as celular,

                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL), '-')) as fecha_sol,

                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_HOR_REF), '-')) as horario                       


                    FROM 
                    	FETVIR_MAE_REF_SOL, FETVIR_MAE_REF 
                    
                    WHERE
                    	FETVIR_MAE_REF_SOL.TVMRS_COD_REF = FETVIR_MAE_REF.TVMRP_COD_REP_K 
                    
                    AND	
						DATE(FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL) = ? 
			
                    
             )tabla            

       </Instruccion01>
	<!-- total Registros busqueda por horario -->
       <Instruccion02>

       		select count(1) from (

                    SELECT 

                    	FETVIR_MAE_REF_SOL.TVMRS_GLS_RUN as rut,

                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_FON), '-')) as fono,

                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_CEL), '-')) as celular,

                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL), '-')) as fecha_sol,

                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_HOR_REF), '-')) as horario

                    FROM 
                    	FETVIR_MAE_REF_SOL, FETVIR_MAE_REF 

                    WHERE 
                    	FETVIR_MAE_REF_SOL.TVMRS_COD_REF = FETVIR_MAE_REF.TVMRP_COD_REP_K
					AND	
						DATE(FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL) = ? 
					AND   		     
		   		     	FETVIR_MAE_REF_SOL.TVMRS_HOR_REF = ?
	                    
				)tabla 

       </Instruccion02>

		<!-- Registros busqueda  por horario-->
       <Instruccion03>

                    SELECT rut, fono,celular, fecha_sol, horario

                    FROM (SELECT  
                    		 	ROW_NUMBER() OVER (order by TVMRS_FCH_SOL) AS C1,

                                FETVIR_MAE_REF_SOL.TVMRS_GLS_RUN as rut,

                        		RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_FON), '-')) as fono,

		                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_CEL), '-')) as celular,	

		                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL), '-')) as fecha_sol,
		
		                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_HOR_REF), '-')) as horario


                                FROM 
                                	FETVIR_MAE_REF_SOL, FETVIR_MAE_REF 

                                WHERE
                                	FETVIR_MAE_REF_SOL.TVMRS_COD_REF = FETVIR_MAE_REF.TVMRP_COD_REP_K 
								AND	
									DATE(FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL) = ? 
								AND   		     
					   		     	FETVIR_MAE_REF_SOL.TVMRS_HOR_REF = ?
				                    
				                ORDER BY TVMRS_FCH_SOL DESC
			            )TABLA

             WHERE TABLA.C1 &#0062; ?

             AND TABLA.C1 &#0060; ?

       </Instruccion03>

<!-- Registros busqueda por fecha -->
       <Instruccion04>

                    SELECT rut, fono,celular, fecha_sol, horario

                    FROM (SELECT  
                    
                    		ROW_NUMBER() OVER (order by TVMRS_FCH_SOL) AS C1,

                            FETVIR_MAE_REF_SOL.TVMRS_GLS_RUN as rut,

                       		RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_FON), '-')) as fono,

	                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_CEL), '-')) as celular,	

	                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL), '-')) as fecha_sol,
	
	                        RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_HOR_REF), '-')) as horario
								
							FROM 
								FETVIR_MAE_REF_SOL, FETVIR_MAE_REF 

                            WHERE 	
                            	FETVIR_MAE_REF_SOL.TVMRS_COD_REF = FETVIR_MAE_REF.TVMRP_COD_REP_K 
                            AND
				                DATE(FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL) = ?
				                
				            ORDER BY TVMRS_FCH_SOL DESC               					                    

                    )TABLA

             WHERE TABLA.C1 &#0062; ?

             AND TABLA.C1 &#0060; ?     

       </Instruccion04>

      

      
     </NombreBean>
     
    <!--  Opciones REFINANCIAMIENTO -->

      <NombreBean valor="gestion_61">
      
      <Instruccion01>
      </Instruccion01>

	<!-- Exportar excel, por fecha -->
       <Instruccion02>
       
	       SELECT  

             FETVIR_MAE_REF_SOL.TVMRS_GLS_RUN as rut,

      		 RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_FON), '-')) as fono,

             RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_CEL), '-')) as celular,	

             RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL), '-')) as fecha_sol,

             RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_HOR_REF), '-')) as horario


           FROM 
           	  	FETVIR_MAE_REF_SOL, FETVIR_MAE_REF 

           WHERE 
           		FETVIR_MAE_REF_SOL.TVMRS_COD_REF = FETVIR_MAE_REF.TVMRP_COD_REP_K
		   AND
		   		DATE(FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL) = ? 
   		     	
   		   ORDER BY TVMRS_FCH_SOL DESC 
       

      </Instruccion02>
	<!-- Exportar excel, con filtro horario-->
       <Instruccion03>
       		SELECT  

             FETVIR_MAE_REF_SOL.TVMRS_GLS_RUN as rut,

      		 RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_FON), '-')) as fono,

             RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_NRO_CEL), '-')) as celular,	

             RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL), '-')) as fecha_sol,

             RTRIM (VALUE (CHAR (FETVIR_MAE_REF_SOL.TVMRS_HOR_REF), '-')) as horario


           FROM 
           		FETVIR_MAE_REF_SOL, FETVIR_MAE_REF

           WHERE 
           		FETVIR_MAE_REF_SOL.TVMRS_COD_ = FETVIR_MAE_REF.TVMRP_COD_REP_K 

		   AND
		   		DATE(FETVIR_MAE_REF_SOL.TVMRS_FCH_SOL) = ?    	
		   AND	
		   		FETVIR_MAE_REF_SOL.TVMRS_HOR_REF = ?	     
		   		
		   ORDER BY TVMRS_FCH_SOL DESC
       </Instruccion03>

      <Instruccion04>
      </Instruccion04>
      
      </NombreBean>
      
      
      
      
      <!--  AGA 20080626
      Reporte stock por StoreId (Arturo Vasquez) -->

      <NombreBean valor="gestion_65">
      
      	<!-- Exportar excel, reporte stock X storeId-->
      <Instruccion01>
      SELECT 
		       RTRIM (VALUE (CHAR (e.partnumber), '-')) as Codigo, 
		       INTEGER(i.quantity) as Stk,
		       INTEGER(PRICE) as PInternet,
		       RTRIM (VALUE (CHAR (e.FIELD5), '-'))  as PVigente,
	           RTRIM (VALUE (CHAR (d.NAME ), '-')) as Marca_Modelo,
	           RTRIM (VALUE (CHAR (IDENTIFIER), '-')) as STORE_ID
	       FROM
        		catentry e, catentdesc d, inventory i, offerprice, offer
        		
           WHERE
           		e.catentry_id = d.catentry_id and
                offer.OFFER_ID= offerprice.OFFER_ID and
                e.CATENTRY_ID  = offer.CATENTRY_ID and
                e.markfordelete = 0 and
                e.buyable = 1 and
                d.published = 1 and
                CATENTTYPE_ID = 'ItemBean' and
                i.catentry_id = e.catentry_id AND
                partnumber LIKE '20%'
                   		     	
   		   ORDER BY 
   		   		e.partnumber ASC
       
      </Instruccion01>


       <Instruccion02>
       </Instruccion02>
	
       <Instruccion03>
       </Instruccion03>

      <Instruccion04>
      </Instruccion04>
      
      </NombreBean>
      
     <!--  AGA 20080806
      Borrado de promociones (Arturo Vasquez) -->

      <NombreBean valor="gestion_66">
      
     <!-- Borrado de todos las promos que tienen al hijo XXXXXXXX -->
      <Instruccion01>
	     DELETE 
	     	FROM MASSOCCECE
		 WHERE 
		 	CATENTRY_ID_TO = (	SELECT CATENTRY_ID FROM CATENTRY WHERE partnumber in('X'))
       
      </Instruccion01>


	   <!-- Borrado de todas las promos asociadas al producto padre XXXXX -->
       <Instruccion02>
       
		DELETE 
			FROM MASSOCCECE
		WHERE
			CATENTRY_ID_FROM = (SELECT CATENTRY_ID FROM catentry where partnumber in('X'));

       </Instruccion02>
	
		<!-- Borrado de la asociacion cuyo padre es XXXXX y su hijo YYYYYY -->
       <Instruccion03>
       	DELETE 
       		FROM MASSOCCECE
		WHERE
			CATENTRY_ID_FROM = (SELECT CATENTRY_ID FROM catentry where partnumber in('PADRE'))
		AND
			CATENTRY_ID_TO = (SELECT CATENTRY_ID FROM catentry where partnumber in('HIJO'));

       </Instruccion03>

      <Instruccion04>
      </Instruccion04>
      
      </NombreBean>
            
            
            
     <!--  AGA 20080808
      Carga Ventas modelo Commerce a modelo TV en DB2 -->

      <NombreBean valor="gestion_70">
      
     <!-- Obtengo datos para tabla 'NOTA_VENTA' -->
      <Instruccion01>
      	SELECT
	        ORDERS_ID,
	        timeplaced,
	        (totalproduct+totalshipping) totalshipping,
	        totaladjustment,
	        RTRIM (VALUE (CHAR (field3), '0')) FIELD3,
	        RTRIM (VALUE (CHAR (member_id), '0')) member_id,
	        RTRIM (VALUE (CHAR (address_id), '0')) address_id,
	        RTRIM (VALUE (CHAR (description), '')) description,
	        RTRIM (VALUE (CHAR (field1), '')) field1
		FROM
			orders 
		WHERE
			ORDERS_ID = ?       
      </Instruccion01>

	   <!-- INSERT TABLA NOTA_VENTA -->
		<Instruccion02>
		INSERT INTO NOTA_VENTA (CORRELATIVO_VENTA, FECHA_CREACION, FECHA_HORA_CREACION, ESTADO, MONTO_VENTA,
								MONTO_DESCUENTO, TIPO_DESCUENTO, RUT_COMPRADOR, DV_COMPRADOR, NUMERO_SUCURSAL,
								CODIGO_REGALO, TIPO_REGALO) 
				VALUES (
       </Instruccion02>
       
       
	  <!--  Recupero RUT de cliente -->
       <Instruccion03>
        SELECT
        	logonid 
        FROM 
        	USERREG
		WHERE
			USERS_ID in (?)
       </Instruccion03>
	       
      <Instruccion04>    
      </Instruccion04>
            
    </NombreBean>
      
      
      
   <!-- AGA 20080811 -->
    <NombreBean valor="gestion_71">
      
     <!-- Obtengo datos del despacho-->
      <Instruccion01>
	     SELECT
	        	RTRIM (VALUE (CHAR (FAX2), '0')) FAX2,
                RTRIM (VALUE (CHAR (FIRSTNAME), '-')) FIRSTNAME,
                RTRIM (VALUE (CHAR (LASTNAME), '-')) LASTNAME,
                RTRIM (VALUE (CHAR (MIDDLENAME), '-')) MIDDLENAME,
                RTRIM (VALUE (CHAR (FIELD1), '0')) FIELD1,
                RTRIM (VALUE (CHAR (STATE), '0')) STATE,
                RTRIM(VALUE (CHAR (ADDRESS1), '-')) ADDRESS1,
                RTRIM(VALUE (CHAR (ADDRESS2), '-')) ADDRESS2,
                RTRIM(VALUE (CHAR (CITY), '-')) CITY,
                RTRIM(VALUE (CHAR (COUNTRY), '-')) COUNTRY,
                RTRIM (VALUE (CHAR (PHONE1), '0')) PHONE1,
                RTRIM (VALUE (CHAR (FIRSTNAME), '0')) FIRSTNAME,
                RTRIM (VALUE (CHAR (LASTNAME), '0')) LASTNAME,
                RTRIM (VALUE (CHAR (MIDDLENAME), '0')) MIDDLENAME,
                RTRIM (VALUE (CHAR (EMAIL1), '0')) EMAIL1
		FROM 
			ADDRESS
		WHERE 
			ADDRESS_ID IN (?)
		       
      </Instruccion01>



       <!-- INSERT TABLA DESPACHO -->
      <Instruccion02>
      	INSERT INTO DESPACHO (CORRELATIVO_VENTA, RUT_DESPACHO, NOMBRE_DESPACHO, FECHA_DESPACHO,
                     SUCURSAL_DESPACHO, COMUNA_DESPACHO, REGION_DESPACHO, DIRECCION_DESPACHO, 
                     TELEFONO_DESPACHO, JORNADA_DESPACHO, OBSERVACION, RUT_CLIENTE,
                     DIRECCION_CLIENTE, TELEFONO_CLIENTE, TIPO_CLIENTE, NOMBRE_CLIENTE,
                     APELLIDO_PAT_CLIENTE, APELLIDO_MAT_CLIENTE, TIPO_DESPACHO, EMAIL_CLIENTE,
                     CODIGO_REGALO, MENSAJE_TARJETA)

             VALUES  (
      </Instruccion02>
	

	<!-- Obtengo comentarios del despacho -->
       <Instruccion03>
       	SELECT
       		comments 
       	FROM
       		ORCOMMENT
		WHERE
			orders_id = ?

       </Instruccion03>

	<!-- Obtengo Id direccin de despacho -->
      <Instruccion04>
        SELECT
                address_id
        FROM
                ORDERITEMS
        WHERE
                orders_id = ?
			
      </Instruccion04>
      
   </NombreBean>
      
 <!-- AGA 20080812 -->
    <NombreBean valor="gestion_72">
      
     <!-- insert table articulo_venta -->
      <Instruccion01>
	    INSERT INTO ARTICULO_VENTA 
					(CORRELATIVO_VENTA, CORRELATIVO_ITEM, COD_ARTICULO, DESC_RIPLEY,
					PRECIO, UNIDADES, COLOR, MONTO_DESCUENTO, TIPO_DESCUENTO, COD_DESPACHO, 
					TIPO_REGALO, ESREGALO, MENSAJE, FEC_NOTA_CREDITO, HORA_NOTA_CREDITO )
		      	VALUES (
      </Instruccion01>
      
      
     <!-- Obtengo datos de los productos--> 
       <Instruccion02>
       	SELECT 
       		   RTRIM (VALUE (CHAR (oi.orders_id), '0')),
       		   RTRIM (VALUE (CHAR (oi.orders_id), '0')), <!-- campo no utilizado, solo para formar el Vector -->
       		   RTRIM (VALUE (CHAR (oi.partnum), '0')) partnum,
		       RTRIM (VALUE (CHAR (oi.basecurrency), '0')), <!-- campo no utilizado, solo para formar el Vector -->
		       INTEGER(oi.price) price,
		       INTEGER(oi.QUANTITY) QUANTITY,
		       INTEGER(xc.PRICE) COSTO_ENVIO,
		       INTEGER(xc.DISCOUNT) DISCOUNT,
		       RTRIM (VALUE (CHAR (xc.SHIPSIZE), '0')) SHIPSIZE, <!-- campo no utilizado, solo para formar el Vector -->
		       RTRIM (VALUE (CHAR (xc.SHIPSIZE), '0')) SHIPSIZE, <!-- campo no utilizado, solo para formar el Vector -->
		       RTRIM (VALUE (CHAR (xc.SHIPSIZE), '0')) SHIPSIZE, <!-- campo no utilizado, solo para formar el Vector -->
		       RTRIM (VALUE (CHAR (xc.SHIPSIZE), '0')) SHIPSIZE, <!-- campo no utilizado, solo para formar el Vector -->
		       RTRIM (VALUE (CHAR (xc.SHIPSIZE), '0')) SHIPSIZE, <!-- campo no utilizado, solo para formar el Vector -->
		       RTRIM (VALUE (CHAR (oi.catentry_id), '0')),
		       INTEGER(xc.QUANTITY) COSTO 
		FROM 
			XCOSTSHIPORDER xc,
		    ORDERITEMS oi
		    
		WHERE 
			oi.ORDERS_ID = xc.ORDERS_ID
		AND
			oi.ORDERS_ID = ?

      	
       </Instruccion02>
	
	<!-- Obtengo descripcion del producto -->
	   <Instruccion03>
	   	SELECT
	   		shortdescription 
	   	FROM
	   		CATENTDESC
		WHERE
			CATENTRY_ID in (?)
       </Instruccion03>

	<!-- Obtengo descripcion del producto para un producto ExtraGarantia-->
	   <Instruccion04>  
	   SELECT
       		DESCRIPCION
       FROM
			XEXTRAGARANTIA
		WHERE
			XEXTRAGARANTIA_ID = ?    
       </Instruccion04> 
      
   </NombreBean>
    
     <!-- Carga Ventas WC-CajaVirtual -->
    <NombreBean valor="gestion_73">
      
     <!-- Obtengo Tipo de despacho, precio, cantidad costo envio-->
      <Instruccion01>
	   	SELECT
	        SHIPSIZE as tamanio,
	        QUANTITY as cantidad,
	        integer(price) costo_envio,
	        integer(discount) as desc_costo_envio
		FROM
			XCOSTSHIPORDER
		WHERE
			ORDERS_ID =?

      </Instruccion01>
          
      <!-- Obtengo SKU para costo envio, segn Region-Comuna -->   
       <Instruccion02>
		SELECT
	        SKU_DESP_SM,
	        SKU_DESP_MED,
	        SKU_DESP_LG,
	        SKU_DESP_PRO
		FROM 
			XSKU_DESPACHO
		WHERE
			XCOMUNA_ID = ?       		 
       </Instruccion02>
	
		<!-- Insert Tabla Tarjeta_bancaria -->
		<Instruccion03>       
		INSERT INTO TARJETA_BANCARIA (CORRELATIVO_VENTA, TIPO_TARJETA, 
									CODIGO_AUTORIZADOR, MONTO_TARJETA)
						VALUES (
       	</Instruccion03>
       
       
       
	<!-- Obtengo Cod. Autorizacion para Tarjeta Bancaria -->
		<Instruccion04>
		SELECT
			value
		FROM
			ORDPAYINFO
		WHERE
			ORDERS_ID in (?)
		AND
			name = 'TBK_CODIGO_AUTORIZACION'
		</Instruccion04>	    
      
   </NombreBean>
   
    
    <!-- AGA 20080813 LIMPIEZA BOLSA DE COMPRAS -->
    <NombreBean valor="gestion_75">
      
     <!-- Obtengo id de usuario -->
      <Instruccion01>
	   	SELECT 
	   		USERS_ID 
	   	FROM 
	   		USERREG
		WHERE
		 	LOGONID = ?

      </Instruccion01>
      
      
     <!-- Limpio tabla Orders --> 
       <Instruccion02>
       		 UPDATE 
       		 	ORDERS
			 SET 
			 	STATUS = 'X'
			 WHERE 
			 	MEMBER_ID IN (?)
			 AND 
			 	STATUS = 'P'
       </Instruccion02>
	
	<!-- Limpio tabla OrdersItem -->
	   <Instruccion03>
		 UPDATE 
		 	ORDERITEMS
		 SET 
		 	STATUS = 'X'
		 WHERE 
		 	MEMBER_ID IN (?)
		 AND 
		 	STATUS = 'P'
       </Instruccion03>

	   <Instruccion04>       
       </Instruccion04> 
      
   </NombreBean>
     
   </NombreProyecto>
</ConsultaSQL>
